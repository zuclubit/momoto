{"version":3,"sources":["../application/use-cases/GenerateComponentTokens.ts","../application/use-cases/EvaluateComponentAccessibility.ts","../application/use-cases/ApplyPerceptualPolicy.ts","../application/use-cases/ExportDesignTokens.ts","../application/use-cases/AuditVisualDecisions.ts"],"names":["__publicField","TokenDerivationService","failure","PerceptualColor","ComponentIntent","success","TokenCollection"],"mappings":"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","file":"chunk-INDVKMSQ.js","sourcesContent":["/**\n * @fileoverview GenerateComponentTokens Use Case\n *\n * Use case para generar una colección completa de tokens para un componente\n * basándose en un color de marca, intención y configuración de estados.\n *\n * @module momoto-ui/application/use-cases/GenerateComponentTokens\n * @version 1.0.0\n */\n\nimport type { Result, ComponentVariant, UIState as UIStateType } from '../../domain/types';\nimport { success, failure } from '../../domain/types';\nimport { PerceptualColor } from '../../domain/perceptual';\nimport { ComponentIntent } from '../../domain/ux';\nimport { TokenCollection, TokenDerivationService } from '../../domain/tokens';\nimport type { TokenRepositoryPort } from '../ports/outbound/TokenRepositoryPort';\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\n/**\n * Input para el use case.\n */\nexport interface GenerateComponentTokensInput {\n  /** Nombre del componente */\n  readonly componentName: string;\n  /** Color de marca en hex */\n  readonly brandColorHex: string;\n  /** Intención del componente */\n  readonly intent: string;\n  /** Variantes a generar */\n  readonly variants?: ComponentVariant[];\n  /** Estados a generar */\n  readonly states?: UIStateType[];\n  /** Si se debe generar escala completa */\n  readonly generateScale?: boolean;\n  /** Namespace para los tokens */\n  readonly namespace?: string;\n}\n\n/**\n * Output del use case.\n */\nexport interface GenerateComponentTokensOutput {\n  /** Colección de tokens generados */\n  readonly collection: TokenCollection;\n  /** Estadísticas de generación */\n  readonly stats: {\n    readonly totalTokens: number;\n    readonly colorTokens: number;\n    readonly stateTokens: number;\n    readonly variantTokens: number;\n  };\n  /** CSS generado */\n  readonly css: string;\n  /** Tokens W3C */\n  readonly w3cTokens: string;\n}\n\n// ============================================================================\n// USE CASE\n// ============================================================================\n\n/**\n * GenerateComponentTokens - Genera tokens completos para un componente.\n *\n * Este use case orquesta la generación de tokens de diseño para un componente\n * específico, incluyendo todos sus estados, variantes y escalas de color.\n *\n * @example\n * ```typescript\n * const useCase = new GenerateComponentTokens(derivationService, tokenRepo);\n *\n * const result = await useCase.execute({\n *   componentName: 'button',\n *   brandColorHex: '#3B82F6',\n *   intent: 'action',\n *   variants: ['solid', 'outline', 'ghost'],\n *   states: ['idle', 'hover', 'active', 'disabled'],\n * });\n *\n * if (result.success) {\n *   console.log(result.value.css);\n *   console.log(`Generated ${result.value.stats.totalTokens} tokens`);\n * }\n * ```\n */\nexport class GenerateComponentTokens {\n  // ─────────────────────────────────────────────────────────────────────────\n  // DEPENDENCIES\n  // ─────────────────────────────────────────────────────────────────────────\n\n  private readonly derivationService: TokenDerivationService;\n  private readonly tokenRepository?: TokenRepositoryPort;\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // CONSTRUCTOR\n  // ─────────────────────────────────────────────────────────────────────────\n\n  constructor(\n    derivationService?: TokenDerivationService,\n    tokenRepository?: TokenRepositoryPort\n  ) {\n    this.derivationService = derivationService || new TokenDerivationService();\n    this.tokenRepository = tokenRepository;\n  }\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // EXECUTION\n  // ─────────────────────────────────────────────────────────────────────────\n\n  /**\n   * Ejecuta el use case.\n   */\n  async execute(\n    input: GenerateComponentTokensInput\n  ): Promise<Result<GenerateComponentTokensOutput, Error>> {\n    try {\n      // 1. Validar input\n      const validationResult = this.validateInput(input);\n      if (!validationResult.success) {\n        return failure(validationResult.error);\n      }\n\n      // 2. Crear color perceptual\n      const colorResult = PerceptualColor.tryFromHex(input.brandColorHex);\n      if (!colorResult.success) {\n        return failure(new Error(`Invalid brand color: ${colorResult.error.message}`));\n      }\n      const brandColor = colorResult.value;\n\n      // 3. Obtener intención\n      const intentResult = ComponentIntent.from(input.intent);\n      if (!intentResult.success) {\n        return failure(new Error(`Invalid intent: ${intentResult.error.message}`));\n      }\n      const intent = intentResult.value;\n\n      // 4. Generar colección base\n      const collection = this.derivationService.deriveComponentTokens(\n        input.componentName,\n        brandColor,\n        intent\n      );\n\n      // 5. Agregar estados adicionales si se especifican\n      if (input.states && input.states.length > 0) {\n        const stateTokens = this.derivationService.deriveStates(\n          `${input.componentName}.base`,\n          brandColor,\n          { component: input.componentName, intent: intent.value }\n        );\n        collection.addAll(stateTokens);\n      }\n\n      // 6. Agregar escala si se solicita\n      if (input.generateScale) {\n        const scaleTokens = this.derivationService.deriveScale(\n          `${input.componentName}.scale`,\n          brandColor,\n          { component: input.componentName }\n        );\n        collection.addAll(scaleTokens);\n      }\n\n      // 7. Guardar en repositorio si está disponible\n      if (this.tokenRepository) {\n        await this.tokenRepository.save(collection);\n      }\n\n      // 8. Generar outputs\n      const stats = this.calculateStats(collection);\n      const css = collection.export({ format: 'css', prefix: input.namespace });\n      const w3cTokens = collection.export({ format: 'w3c' });\n\n      return success({\n        collection,\n        stats,\n        css,\n        w3cTokens,\n      });\n    } catch (error) {\n      return failure(\n        error instanceof Error ? error : new Error('Unknown error during token generation')\n      );\n    }\n  }\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // PRIVATE METHODS\n  // ─────────────────────────────────────────────────────────────────────────\n\n  /**\n   * Valida el input del use case.\n   */\n  private validateInput(input: GenerateComponentTokensInput): Result<void, Error> {\n    if (!input.componentName || input.componentName.trim().length === 0) {\n      return failure(new Error('Component name is required'));\n    }\n\n    if (!input.brandColorHex || input.brandColorHex.trim().length === 0) {\n      return failure(new Error('Brand color hex is required'));\n    }\n\n    if (!/^#[0-9A-Fa-f]{6}$/.test(input.brandColorHex)) {\n      return failure(new Error('Brand color must be a valid 6-digit hex color'));\n    }\n\n    if (!input.intent || input.intent.trim().length === 0) {\n      return failure(new Error('Intent is required'));\n    }\n\n    return success(undefined);\n  }\n\n  /**\n   * Calcula estadísticas de la colección.\n   */\n  private calculateStats(collection: TokenCollection) {\n    const all = collection.all();\n    const colorTokens = collection.byType('color').length;\n    const stateTokens = collection.filter({ state: 'hover' }).length +\n                        collection.filter({ state: 'active' }).length +\n                        collection.filter({ state: 'disabled' }).length +\n                        collection.filter({ state: 'focus' }).length;\n\n    return {\n      totalTokens: all.length,\n      colorTokens,\n      stateTokens,\n      variantTokens: all.length - colorTokens,\n    };\n  }\n}\n\n// ============================================================================\n// EXPORTS\n// ============================================================================\n\nexport default GenerateComponentTokens;\n","/**\n * @fileoverview EvaluateComponentAccessibility Use Case\n *\n * Use case para evaluar la accesibilidad de los colores de un componente\n * según estándares WCAG 2.1 y APCA.\n *\n * @module momoto-ui/application/use-cases/EvaluateComponentAccessibility\n * @version 1.0.0\n */\n\nimport type { Result, WcagLevel, ApcaLevel } from '../../domain/types';\nimport { success, failure } from '../../domain/types';\nimport { PerceptualColor } from '../../domain/perceptual';\nimport { TokenCollection } from '../../domain/tokens';\nimport type { AuditPort } from '../ports/outbound/AuditPort';\n\n// ============================================================================\n// LOCAL TYPES\n// ============================================================================\n\n/**\n * Accessibility violation for audit logging.\n * Defined locally as it's specific to this use case.\n */\nexport interface AccessibilityViolation {\n  readonly type: 'contrast' | 'color-blind' | 'motion';\n  readonly severity: 'error' | 'warning' | 'info';\n  readonly element: string;\n  readonly message: string;\n  readonly wcagCriteria?: string;\n  readonly foreground?: string;\n  readonly background?: string;\n  readonly actualRatio?: number;\n  readonly requiredRatio?: number;\n  readonly suggestion?: string;\n}\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\n/**\n * Par de colores a evaluar.\n */\nexport interface ColorPair {\n  readonly name: string;\n  readonly foreground: string;\n  readonly background: string;\n  readonly role?: string;\n  readonly minimumWcagLevel?: WcagLevel;\n  readonly minimumApcaLevel?: ApcaLevel;\n}\n\n/**\n * Input para el use case.\n */\nexport interface EvaluateAccessibilityInput {\n  /** Pares de colores a evaluar */\n  readonly colorPairs?: ColorPair[];\n  /** Colección de tokens a evaluar */\n  readonly tokenCollection?: TokenCollection;\n  /** Nivel WCAG requerido */\n  readonly requiredWcagLevel: WcagLevel;\n  /** Nivel APCA requerido */\n  readonly requiredApcaLevel: ApcaLevel;\n  /** Si debe fallar en la primera violación */\n  readonly failFast?: boolean;\n}\n\n/**\n * Resultado de evaluación de un par.\n */\nexport interface PairEvaluationResult {\n  readonly pairName: string;\n  readonly foreground: string;\n  readonly background: string;\n  readonly wcag: {\n    readonly ratio: number;\n    readonly level: WcagLevel;\n    readonly passesAA: boolean;\n    readonly passesAAA: boolean;\n    readonly passesAALarge: boolean;\n  };\n  readonly apca: {\n    readonly contrast: number;\n    readonly level: ApcaLevel;\n    readonly passesBodyText: boolean;\n    readonly passesHeading: boolean;\n    readonly passesNonText: boolean;\n  };\n  readonly passes: boolean;\n  readonly violations: string[];\n  readonly recommendations: string[];\n}\n\n/**\n * Output del use case.\n */\nexport interface EvaluateAccessibilityOutput {\n  /** Si pasa todos los criterios */\n  readonly passes: boolean;\n  /** Número de pares evaluados */\n  readonly totalPairs: number;\n  /** Número de pares que pasan */\n  readonly passingPairs: number;\n  /** Número de violaciones */\n  readonly violationCount: number;\n  /** Resultados por par */\n  readonly results: PairEvaluationResult[];\n  /** Resumen de violaciones */\n  readonly violations: AccessibilityViolation[];\n  /** Score general (0-100) */\n  readonly score: number;\n  /** Recomendaciones generales */\n  readonly recommendations: string[];\n}\n\n// ============================================================================\n// CONSTANTS\n// ============================================================================\n\n/**\n * Ratios mínimos WCAG mapped to WcagLevel type.\n */\nconst WCAG_RATIOS: Record<WcagLevel, number> = {\n  'Fail': 0,     // Below minimum\n  'A': 3.0,      // Minimum for large text\n  'AA': 4.5,     // Standard requirement\n  'AAA': 7.0,    // Enhanced requirement\n} as const;\n\n/**\n * Contrastes mínimos APCA mapped to ApcaLevel type.\n */\nconst APCA_LEVELS: Record<ApcaLevel, number> = {\n  'fail': 0,        // Below minimum\n  'minimum': 15,    // Decorative only\n  'spot': 30,       // Non-text, icons\n  'large': 45,      // Large text, headings\n  'body': 60,       // Standard body text\n  'fluent': 75,     // Optimal reading\n  'excellent': 90,  // Maximum readability\n} as const;\n\n/**\n * Thresholds for AA-large (legacy support).\n */\nconst WCAG_AA_LARGE_RATIO = 3.0;\n\n// ============================================================================\n// USE CASE\n// ============================================================================\n\n/**\n * EvaluateComponentAccessibility - Evalúa accesibilidad de colores.\n *\n * Evalúa pares de colores foreground/background según:\n * - WCAG 2.1 contrast ratio (AA, AAA)\n * - APCA (Accessible Perceptual Contrast Algorithm)\n *\n * @example\n * ```typescript\n * const useCase = new EvaluateComponentAccessibility();\n *\n * const result = await useCase.execute({\n *   colorPairs: [\n *     { name: 'button', foreground: '#FFFFFF', background: '#3B82F6' },\n *     { name: 'text', foreground: '#1F2937', background: '#FFFFFF' },\n *   ],\n *   requiredWcagLevel: 'AA',\n *   requiredApcaLevel: 'Lc60',\n * });\n *\n * if (result.success && result.value.passes) {\n *   console.log('All pairs pass accessibility requirements');\n * } else {\n *   console.log('Violations:', result.value.violations);\n * }\n * ```\n */\nexport class EvaluateComponentAccessibility {\n  // ─────────────────────────────────────────────────────────────────────────\n  // DEPENDENCIES\n  // ─────────────────────────────────────────────────────────────────────────\n\n  private readonly auditPort?: AuditPort;\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // CONSTRUCTOR\n  // ─────────────────────────────────────────────────────────────────────────\n\n  constructor(auditPort?: AuditPort) {\n    this.auditPort = auditPort;\n  }\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // EXECUTION\n  // ─────────────────────────────────────────────────────────────────────────\n\n  /**\n   * Ejecuta la evaluación de accesibilidad.\n   */\n  async execute(\n    input: EvaluateAccessibilityInput\n  ): Promise<Result<EvaluateAccessibilityOutput, Error>> {\n    try {\n      // 1. Obtener pares a evaluar\n      const pairs = this.resolvePairs(input);\n      if (pairs.length === 0) {\n        return failure(new Error('No color pairs to evaluate'));\n      }\n\n      // 2. Evaluar cada par\n      const results: PairEvaluationResult[] = [];\n      const violations: AccessibilityViolation[] = [];\n\n      for (const pair of pairs) {\n        const result = this.evaluatePair(pair, input);\n        results.push(result);\n\n        if (!result.passes) {\n          violations.push(...this.createViolations(result, input));\n\n          if (input.failFast) {\n            break;\n          }\n        }\n      }\n\n      // 3. Calcular estadísticas\n      const passingPairs = results.filter(r => r.passes).length;\n      const score = Math.round((passingPairs / results.length) * 100);\n\n      // 4. Generar recomendaciones\n      const recommendations = this.generateRecommendations(results, input);\n\n      // 5. Log audit si está disponible\n      if (this.auditPort && results.length > 0) {\n        // Log each evaluation individually\n        for (const result of results) {\n          const fgResult = PerceptualColor.tryFromHex(result.foreground);\n          const bgResult = PerceptualColor.tryFromHex(result.background);\n          if (fgResult.success && bgResult.success) {\n            await this.auditPort.logAccessibilityEvaluation({\n              foreground: fgResult.value,\n              background: bgResult.value,\n              wcagRatio: result.wcag.ratio,\n              apcaLevel: result.apca.contrast,\n              requiredLevel: input.requiredWcagLevel,\n              passes: result.passes,\n              component: result.pairName,\n            });\n          }\n        }\n      }\n\n      const output: EvaluateAccessibilityOutput = {\n        passes: violations.length === 0,\n        totalPairs: pairs.length,\n        passingPairs,\n        violationCount: violations.length,\n        results,\n        violations,\n        score,\n        recommendations,\n      };\n\n      return success(output);\n    } catch (error) {\n      return failure(\n        error instanceof Error\n          ? error\n          : new Error('Unknown error during accessibility evaluation')\n      );\n    }\n  }\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // PAIR RESOLUTION\n  // ─────────────────────────────────────────────────────────────────────────\n\n  /**\n   * Resuelve los pares a evaluar desde input.\n   */\n  private resolvePairs(input: EvaluateAccessibilityInput): ColorPair[] {\n    const pairs: ColorPair[] = [];\n\n    // Agregar pares directos\n    if (input.colorPairs) {\n      pairs.push(...input.colorPairs);\n    }\n\n    // Extraer pares de colección de tokens\n    if (input.tokenCollection) {\n      const tokenPairs = this.extractPairsFromCollection(input.tokenCollection);\n      pairs.push(...tokenPairs);\n    }\n\n    return pairs;\n  }\n\n  /**\n   * Extrae pares de colores de una colección de tokens.\n   */\n  private extractPairsFromCollection(collection: TokenCollection): ColorPair[] {\n    const pairs: ColorPair[] = [];\n    const colorTokens = collection.byType('color');\n\n    // Buscar pares de background/text\n    const backgrounds = colorTokens.filter(t =>\n      t.context.role === 'background' ||\n      t.context.role === 'surface' ||\n      t.name.includes('.bg')\n    );\n\n    const texts = colorTokens.filter(t =>\n      t.context.role?.startsWith('text') ||\n      t.name.includes('.text')\n    );\n\n    for (const bg of backgrounds) {\n      for (const text of texts) {\n        // Solo emparejar si pertenecen al mismo componente o namespace\n        if (bg.namespace === text.namespace || bg.context.component === text.context.component) {\n          pairs.push({\n            name: `${bg.name} / ${text.name}`,\n            background: bg.toCssValue(),\n            foreground: text.toCssValue(),\n            role: text.context.role,\n          });\n        }\n      }\n    }\n\n    return pairs;\n  }\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // EVALUATION\n  // ─────────────────────────────────────────────────────────────────────────\n\n  /**\n   * Evalúa un par de colores.\n   */\n  private evaluatePair(\n    pair: ColorPair,\n    input: EvaluateAccessibilityInput\n  ): PairEvaluationResult {\n    const fgResult = PerceptualColor.tryFromHex(pair.foreground);\n    const bgResult = PerceptualColor.tryFromHex(pair.background);\n\n    if (!fgResult.success || !bgResult.success) {\n      return this.createErrorResult(pair, 'Invalid color value');\n    }\n\n    const fgColor = fgResult.value;\n    const bgColor = bgResult.value;\n\n    // Calcular WCAG\n    const wcagRatio = this.calculateWcagRatio(fgColor, bgColor);\n    const wcagLevel = this.determineWcagLevel(wcagRatio);\n    const passesAA = wcagRatio >= WCAG_RATIOS.AA;\n    const passesAAA = wcagRatio >= WCAG_RATIOS.AAA;\n    const passesAALarge = wcagRatio >= WCAG_AA_LARGE_RATIO;\n\n    // Calcular APCA\n    const apcaContrast = this.calculateApcaContrast(fgColor, bgColor);\n    const apcaLevel = this.determineApcaLevel(apcaContrast);\n    const passesBodyText = Math.abs(apcaContrast) >= APCA_LEVELS.fluent;\n    const passesHeading = Math.abs(apcaContrast) >= APCA_LEVELS.body;\n    const passesNonText = Math.abs(apcaContrast) >= APCA_LEVELS.spot;\n\n    // Determinar si pasa según requisitos\n    const violations: string[] = [];\n    const recommendations: string[] = [];\n\n    // Verificar WCAG\n    if (input.requiredWcagLevel === 'AAA' && !passesAAA) {\n      violations.push(`WCAG AAA requires ratio >= 7.0, got ${wcagRatio.toFixed(2)}`);\n    } else if (input.requiredWcagLevel === 'AA' && !passesAA) {\n      violations.push(`WCAG AA requires ratio >= 4.5, got ${wcagRatio.toFixed(2)}`);\n    }\n\n    // Verificar APCA\n    const requiredApca = APCA_LEVELS[input.requiredApcaLevel];\n    if (Math.abs(apcaContrast) < requiredApca) {\n      violations.push(\n        `APCA ${input.requiredApcaLevel} requires |Lc| >= ${requiredApca}, got ${apcaContrast.toFixed(1)}`\n      );\n    }\n\n    // Generar recomendaciones\n    if (!passesAA && passesAALarge) {\n      recommendations.push('Consider using this combination only for large text (18pt+ or 14pt bold)');\n    }\n\n    if (!passesBodyText && passesHeading) {\n      recommendations.push('This contrast is suitable for headings but not body text');\n    }\n\n    return {\n      pairName: pair.name,\n      foreground: pair.foreground,\n      background: pair.background,\n      wcag: {\n        ratio: wcagRatio,\n        level: wcagLevel,\n        passesAA,\n        passesAAA,\n        passesAALarge,\n      },\n      apca: {\n        contrast: apcaContrast,\n        level: apcaLevel,\n        passesBodyText,\n        passesHeading,\n        passesNonText,\n      },\n      passes: violations.length === 0,\n      violations,\n      recommendations,\n    };\n  }\n\n  /**\n   * Crea resultado de error.\n   */\n  private createErrorResult(pair: ColorPair, error: string): PairEvaluationResult {\n    return {\n      pairName: pair.name,\n      foreground: pair.foreground,\n      background: pair.background,\n      wcag: {\n        ratio: 0,\n        level: 'Fail',\n        passesAA: false,\n        passesAAA: false,\n        passesAALarge: false,\n      },\n      apca: {\n        contrast: 0,\n        level: 'fail',\n        passesBodyText: false,\n        passesHeading: false,\n        passesNonText: false,\n      },\n      passes: false,\n      violations: [error],\n      recommendations: [],\n    };\n  }\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // CALCULATIONS\n  // ─────────────────────────────────────────────────────────────────────────\n\n  /**\n   * Calcula ratio de contraste WCAG 2.1.\n   */\n  private calculateWcagRatio(fg: PerceptualColor, bg: PerceptualColor): number {\n    const fgRgb = fg.rgb;\n    const bgRgb = bg.rgb;\n\n    const luminance = (rgb: { r: number; g: number; b: number }) => {\n      const [r, g, b] = [rgb.r, rgb.g, rgb.b].map(v => {\n        v = v / 255;\n        return v <= 0.03928 ? v / 12.92 : Math.pow((v + 0.055) / 1.055, 2.4);\n      });\n      return 0.2126 * r + 0.7152 * g + 0.0722 * b;\n    };\n\n    const l1 = luminance(fgRgb);\n    const l2 = luminance(bgRgb);\n    const lighter = Math.max(l1, l2);\n    const darker = Math.min(l1, l2);\n\n    return (lighter + 0.05) / (darker + 0.05);\n  }\n\n  /**\n   * Calcula contraste APCA.\n   */\n  private calculateApcaContrast(fg: PerceptualColor, bg: PerceptualColor): number {\n    const fgRgb = fg.rgb;\n    const bgRgb = bg.rgb;\n\n    const toY = (rgb: { r: number; g: number; b: number }) => {\n      const [r, g, b] = [rgb.r, rgb.g, rgb.b].map(v => Math.pow(v / 255, 2.4));\n      return 0.2126729 * r + 0.7151522 * g + 0.0721750 * b;\n    };\n\n    const yBg = toY(bgRgb);\n    const yFg = toY(fgRgb);\n\n    const polarity = yBg > yFg ? 1 : -1;\n    const normBG = Math.pow(yBg, 0.56);\n    const normTXT = Math.pow(yFg, 0.57);\n    const SAPC = (normBG - normTXT) * 1.14;\n\n    return SAPC * 100 * polarity;\n  }\n\n  /**\n   * Determina nivel WCAG.\n   */\n  private determineWcagLevel(ratio: number): WcagLevel {\n    if (ratio >= WCAG_RATIOS.AAA) return 'AAA';\n    if (ratio >= WCAG_RATIOS.AA) return 'AA';\n    if (ratio >= WCAG_RATIOS.A) return 'A';\n    return 'Fail';\n  }\n\n  /**\n   * Determina nivel APCA.\n   */\n  private determineApcaLevel(contrast: number): ApcaLevel {\n    const absContrast = Math.abs(contrast);\n    if (absContrast >= APCA_LEVELS.excellent) return 'excellent';\n    if (absContrast >= APCA_LEVELS.fluent) return 'fluent';\n    if (absContrast >= APCA_LEVELS.body) return 'body';\n    if (absContrast >= APCA_LEVELS.large) return 'large';\n    if (absContrast >= APCA_LEVELS.spot) return 'spot';\n    if (absContrast >= APCA_LEVELS.minimum) return 'minimum';\n    return 'fail';\n  }\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // VIOLATIONS & RECOMMENDATIONS\n  // ─────────────────────────────────────────────────────────────────────────\n\n  /**\n   * Crea objetos de violación para audit.\n   */\n  private createViolations(\n    result: PairEvaluationResult,\n    input: EvaluateAccessibilityInput\n  ): AccessibilityViolation[] {\n    return result.violations.map(message => ({\n      type: 'contrast',\n      severity: 'error',\n      element: result.pairName,\n      message,\n      wcagCriteria: input.requiredWcagLevel === 'AAA' ? '1.4.6' : '1.4.3',\n      foreground: result.foreground,\n      background: result.background,\n      actualRatio: result.wcag.ratio,\n      requiredRatio: WCAG_RATIOS[input.requiredWcagLevel],\n      suggestion: this.generateFixSuggestion(result),\n    }));\n  }\n\n  /**\n   * Genera sugerencia de corrección.\n   */\n  private generateFixSuggestion(result: PairEvaluationResult): string {\n    const bgColor = PerceptualColor.tryFromHex(result.background);\n    const fgColor = PerceptualColor.tryFromHex(result.foreground);\n\n    if (!bgColor.success || !fgColor.success) {\n      return 'Adjust colors to meet contrast requirements';\n    }\n\n    const bgL = bgColor.value.oklch.l;\n    const fgL = fgColor.value.oklch.l;\n\n    if (bgL > 0.5) {\n      // Fondo claro - oscurecer texto\n      return `Try darkening the foreground. Current lightness: ${(fgL * 100).toFixed(0)}%. Suggested: ${Math.max(0, (fgL - 0.2) * 100).toFixed(0)}%`;\n    } else {\n      // Fondo oscuro - aclarar texto\n      return `Try lightening the foreground. Current lightness: ${(fgL * 100).toFixed(0)}%. Suggested: ${Math.min(100, (fgL + 0.2) * 100).toFixed(0)}%`;\n    }\n  }\n\n  /**\n   * Genera recomendaciones generales.\n   */\n  private generateRecommendations(\n    results: PairEvaluationResult[],\n    _input: EvaluateAccessibilityInput\n  ): string[] {\n    const recommendations: string[] = [];\n    const failingCount = results.filter(r => !r.passes).length;\n\n    if (failingCount > results.length / 2) {\n      recommendations.push(\n        'More than half of color pairs fail accessibility requirements. Consider reviewing the color palette.'\n      );\n    }\n\n    const lowContrastPairs = results.filter(r => r.wcag.ratio < 3.0);\n    if (lowContrastPairs.length > 0) {\n      recommendations.push(\n        `${lowContrastPairs.length} pair(s) have very low contrast (< 3:1). These should be used only for decorative purposes.`\n      );\n    }\n\n    const apcaOnlyPairs = results.filter(r =>\n      !r.wcag.passesAA && r.apca.passesHeading\n    );\n    if (apcaOnlyPairs.length > 0) {\n      recommendations.push(\n        `${apcaOnlyPairs.length} pair(s) pass APCA but fail WCAG. Consider APCA for perceptual accuracy, but WCAG for legal compliance.`\n      );\n    }\n\n    return recommendations;\n  }\n}\n\n// ============================================================================\n// EXPORTS\n// ============================================================================\n\nexport default EvaluateComponentAccessibility;\n","/**\n * @fileoverview ApplyPerceptualPolicy Use Case\n *\n * Use case para aplicar políticas perceptuales a colecciones de tokens,\n * garantizando consistencia perceptual y accesibilidad.\n *\n * Las políticas perceptuales definen:\n * - Rangos de luminosidad permitidos\n * - Diferencias mínimas de contraste\n * - Armonías de color\n * - Consistencia de saturación\n *\n * @module momoto-ui/application/use-cases/ApplyPerceptualPolicy\n * @version 1.0.0\n */\n\nimport type { Result } from '../../domain/types';\nimport { success, failure } from '../../domain/types';\nimport { PerceptualColor } from '../../domain/perceptual';\nimport { TokenCollection, DesignToken } from '../../domain/tokens';\nimport type { AuditPort } from '../ports/outbound/AuditPort';\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\n/**\n * Política de luminosidad.\n */\nexport interface LightnessPolicy {\n  /** Luminosidad mínima permitida */\n  readonly min: number;\n  /** Luminosidad máxima permitida */\n  readonly max: number;\n  /** Si ajustar automáticamente tokens fuera de rango */\n  readonly autoAdjust: boolean;\n}\n\n/**\n * Política de saturación.\n */\nexport interface ChromaPolicy {\n  /** Saturación mínima permitida */\n  readonly min: number;\n  /** Saturación máxima permitida */\n  readonly max: number;\n  /** Tolerancia de variación entre tokens relacionados */\n  readonly varianceTolerance: number;\n  /** Si ajustar automáticamente */\n  readonly autoAdjust: boolean;\n}\n\n/**\n * Política de contraste.\n */\nexport interface ContrastPolicy {\n  /** Ratio mínimo WCAG */\n  readonly minWcagRatio: number;\n  /** Nivel mínimo APCA */\n  readonly minApcaLevel: number;\n  /** Pares que deben cumplir (ej: ['text', 'background']) */\n  readonly requiredPairs: Array<[string, string]>;\n  /** Acción si falla */\n  readonly onFailure: 'warn' | 'error' | 'adjust';\n}\n\n/**\n * Política de armonía.\n */\nexport interface HarmonyPolicy {\n  /** Tipo de armonía */\n  readonly type: 'complementary' | 'analogous' | 'triadic' | 'split-complementary' | 'tetradic' | 'none';\n  /** Tolerancia en grados */\n  readonly hueTolerance: number;\n  /** Si ajustar automáticamente */\n  readonly autoAdjust: boolean;\n}\n\n/**\n * Política perceptual completa.\n */\nexport interface PerceptualPolicy {\n  /** Nombre de la política */\n  readonly name: string;\n  /** Descripción */\n  readonly description?: string;\n  /** Política de luminosidad */\n  readonly lightness?: LightnessPolicy;\n  /** Política de saturación */\n  readonly chroma?: ChromaPolicy;\n  /** Política de contraste */\n  readonly contrast?: ContrastPolicy;\n  /** Política de armonía */\n  readonly harmony?: HarmonyPolicy;\n  /** Si es política estricta (falla en cualquier violación) */\n  readonly strict?: boolean;\n}\n\n/**\n * Violación de política detectada.\n */\nexport interface PolicyViolation {\n  /** Token que viola */\n  readonly token: DesignToken;\n  /** Regla violada */\n  readonly rule: 'lightness' | 'chroma' | 'contrast' | 'harmony';\n  /** Valor actual */\n  readonly actualValue: number | string;\n  /** Valor esperado */\n  readonly expectedValue: string;\n  /** Severidad */\n  readonly severity: 'warning' | 'error';\n  /** Sugerencia de corrección */\n  readonly suggestion?: string;\n  /** Token corregido si autoAdjust está activo */\n  readonly correctedToken?: DesignToken;\n}\n\n/**\n * Input para el use case.\n */\nexport interface ApplyPerceptualPolicyInput {\n  /** Colección de tokens a evaluar */\n  readonly collection: TokenCollection;\n  /** Política a aplicar */\n  readonly policy: PerceptualPolicy;\n  /** Si aplicar correcciones automáticas */\n  readonly applyCorrections?: boolean;\n  /** Si generar reporte detallado */\n  readonly generateReport?: boolean;\n}\n\n/**\n * Output del use case.\n */\nexport interface ApplyPerceptualPolicyOutput {\n  /** Si la colección cumple la política */\n  readonly compliant: boolean;\n  /** Violaciones encontradas */\n  readonly violations: PolicyViolation[];\n  /** Colección corregida (si applyCorrections es true) */\n  readonly correctedCollection?: TokenCollection;\n  /** Resumen de cumplimiento */\n  readonly summary: {\n    readonly totalTokens: number;\n    readonly compliantTokens: number;\n    readonly warningCount: number;\n    readonly errorCount: number;\n    readonly correctedCount: number;\n    readonly complianceRate: number;\n  };\n  /** Reporte detallado si se solicitó */\n  readonly report?: string;\n}\n\n// ============================================================================\n// PRESET POLICIES\n// ============================================================================\n\n/**\n * Políticas perceptuales predefinidas.\n */\nexport const PRESET_POLICIES: Record<string, PerceptualPolicy> = {\n  /** Política estándar WCAG AA */\n  wcagAA: {\n    name: 'WCAG 2.1 AA',\n    description: 'Cumplimiento mínimo WCAG 2.1 nivel AA',\n    lightness: { min: 0, max: 100, autoAdjust: false },\n    chroma: { min: 0, max: 150, varianceTolerance: 20, autoAdjust: false },\n    contrast: {\n      minWcagRatio: 4.5,\n      minApcaLevel: 60,\n      requiredPairs: [['foreground', 'background']],\n      onFailure: 'error',\n    },\n    strict: false,\n  },\n\n  /** Política estricta WCAG AAA */\n  wcagAAA: {\n    name: 'WCAG 2.1 AAA',\n    description: 'Cumplimiento WCAG 2.1 nivel AAA',\n    lightness: { min: 10, max: 90, autoAdjust: true },\n    chroma: { min: 0, max: 130, varianceTolerance: 15, autoAdjust: true },\n    contrast: {\n      minWcagRatio: 7.0,\n      minApcaLevel: 75,\n      requiredPairs: [['foreground', 'background']],\n      onFailure: 'error',\n    },\n    strict: true,\n  },\n\n  /** Política de alto contraste */\n  highContrast: {\n    name: 'High Contrast',\n    description: 'Alto contraste para usuarios con baja visión',\n    lightness: { min: 0, max: 100, autoAdjust: true },\n    contrast: {\n      minWcagRatio: 10.0,\n      minApcaLevel: 90,\n      requiredPairs: [['foreground', 'background']],\n      onFailure: 'adjust',\n    },\n    strict: true,\n  },\n\n  /** Política de armonía de marca */\n  brandHarmony: {\n    name: 'Brand Harmony',\n    description: 'Consistencia cromática para identidad de marca',\n    chroma: { min: 30, max: 100, varianceTolerance: 10, autoAdjust: true },\n    harmony: {\n      type: 'analogous',\n      hueTolerance: 30,\n      autoAdjust: true,\n    },\n    strict: false,\n  },\n\n  /** Política permisiva (solo warnings) */\n  lenient: {\n    name: 'Lenient',\n    description: 'Política permisiva que solo genera warnings',\n    contrast: {\n      minWcagRatio: 3.0,\n      minApcaLevel: 45,\n      requiredPairs: [],\n      onFailure: 'warn',\n    },\n    strict: false,\n  },\n};\n\n// ============================================================================\n// USE CASE\n// ============================================================================\n\n/**\n * ApplyPerceptualPolicy - Aplica políticas perceptuales a tokens.\n *\n * Este use case evalúa una colección de tokens contra una política\n * perceptual, identificando violaciones y opcionalmente corrigiéndolas.\n *\n * @example\n * ```typescript\n * const useCase = new ApplyPerceptualPolicy(auditService);\n *\n * const result = await useCase.execute({\n *   collection: tokenCollection,\n *   policy: PRESET_POLICIES.wcagAA,\n *   applyCorrections: true,\n *   generateReport: true,\n * });\n *\n * if (result.success) {\n *   if (result.value.compliant) {\n *     console.log('All tokens are compliant!');\n *   } else {\n *     console.log(`Found ${result.value.violations.length} violations`);\n *     if (result.value.correctedCollection) {\n *       // Use corrected collection\n *     }\n *   }\n * }\n * ```\n */\nexport class ApplyPerceptualPolicy {\n  // ─────────────────────────────────────────────────────────────────────────\n  // DEPENDENCIES\n  // ─────────────────────────────────────────────────────────────────────────\n\n  private readonly auditPort?: AuditPort;\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // CONSTRUCTOR\n  // ─────────────────────────────────────────────────────────────────────────\n\n  constructor(auditPort?: AuditPort) {\n    this.auditPort = auditPort;\n  }\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // EXECUTION\n  // ─────────────────────────────────────────────────────────────────────────\n\n  /**\n   * Ejecuta el use case.\n   */\n  async execute(\n    input: ApplyPerceptualPolicyInput\n  ): Promise<Result<ApplyPerceptualPolicyOutput, Error>> {\n    try {\n      const { collection, policy, applyCorrections = false, generateReport = false } = input;\n\n      // Validar input\n      if (!collection || collection.all().length === 0) {\n        return failure(new Error('Token collection is empty'));\n      }\n\n      const violations: PolicyViolation[] = [];\n      const colorTokens = collection.byType('color');\n\n      // Evaluar cada token de color\n      for (const token of colorTokens) {\n        const tokenViolations = this.evaluateToken(token, policy);\n        violations.push(...tokenViolations);\n      }\n\n      // Aplicar correcciones si se solicita\n      let correctedCollection: TokenCollection | undefined;\n      let correctedCount = 0;\n\n      if (applyCorrections && violations.some(v => v.correctedToken)) {\n        correctedCollection = this.createCorrectedCollection(collection, violations);\n        correctedCount = violations.filter(v => v.correctedToken).length;\n      }\n\n      // Calcular resumen\n      const summary = this.calculateSummary(collection, violations, correctedCount);\n\n      // Registrar en auditoría si está disponible\n      if (this.auditPort) {\n        await this.auditPort.log({\n          category: 'validation',\n          severity: summary.errorCount > 0 ? 'warning' : 'info',\n          message: `Perceptual policy \"${policy.name}\" applied to ${summary.totalTokens} tokens`,\n          data: {\n            policyName: policy.name,\n            complianceRate: summary.complianceRate,\n            violationCount: violations.length,\n            correctedCount,\n          },\n        });\n      }\n\n      // Generar reporte si se solicita\n      let report: string | undefined;\n      if (generateReport) {\n        report = this.generateReport(policy, violations, summary);\n      }\n\n      return success({\n        compliant: violations.filter(v => v.severity === 'error').length === 0,\n        violations,\n        correctedCollection,\n        summary,\n        report,\n      });\n    } catch (error) {\n      return failure(\n        error instanceof Error ? error : new Error('Unknown error during policy evaluation')\n      );\n    }\n  }\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // PRIVATE METHODS\n  // ─────────────────────────────────────────────────────────────────────────\n\n  /**\n   * Evalúa un token contra la política.\n   */\n  private evaluateToken(token: DesignToken, policy: PerceptualPolicy): PolicyViolation[] {\n    const violations: PolicyViolation[] = [];\n\n    // Obtener color del token\n    const colorHex = token.toCssVariable().replace(/var\\(--[^)]+\\)/, '').trim();\n    const colorResult = PerceptualColor.tryFromHex(colorHex);\n\n    if (!colorResult.success) {\n      return violations; // Skip non-color tokens\n    }\n\n    const color = colorResult.value;\n    const oklch = color.oklch;\n\n    // Evaluar luminosidad\n    if (policy.lightness) {\n      const violation = this.evaluateLightness(token, oklch.l * 100, policy.lightness);\n      if (violation) violations.push(violation);\n    }\n\n    // Evaluar saturación\n    if (policy.chroma) {\n      const violation = this.evaluateChroma(token, oklch.c * 100, policy.chroma);\n      if (violation) violations.push(violation);\n    }\n\n    return violations;\n  }\n\n  /**\n   * Evalúa política de luminosidad.\n   */\n  private evaluateLightness(\n    token: DesignToken,\n    lightness: number,\n    policy: LightnessPolicy\n  ): PolicyViolation | null {\n    if (lightness < policy.min || lightness > policy.max) {\n      const correctedToken = policy.autoAdjust\n        ? this.adjustLightness(token, lightness, policy)\n        : undefined;\n\n      return {\n        token,\n        rule: 'lightness',\n        actualValue: lightness.toFixed(1),\n        expectedValue: `${policy.min}-${policy.max}`,\n        severity: 'error',\n        suggestion: `Adjust lightness to be within ${policy.min}-${policy.max}`,\n        correctedToken,\n      };\n    }\n    return null;\n  }\n\n  /**\n   * Evalúa política de saturación.\n   */\n  private evaluateChroma(\n    token: DesignToken,\n    chroma: number,\n    policy: ChromaPolicy\n  ): PolicyViolation | null {\n    if (chroma < policy.min || chroma > policy.max) {\n      const correctedToken = policy.autoAdjust\n        ? this.adjustChroma(token, chroma, policy)\n        : undefined;\n\n      return {\n        token,\n        rule: 'chroma',\n        actualValue: chroma.toFixed(1),\n        expectedValue: `${policy.min}-${policy.max}`,\n        severity: 'warning',\n        suggestion: `Adjust chroma to be within ${policy.min}-${policy.max}`,\n        correctedToken,\n      };\n    }\n    return null;\n  }\n\n  /**\n   * Ajusta luminosidad de un token.\n   */\n  private adjustLightness(\n    token: DesignToken,\n    currentLightness: number,\n    _policy: LightnessPolicy\n  ): DesignToken {\n    // Simplified placeholder - would calculate target based on policy.min/max\n    // and currentLightness, then adjust token color accordingly\n    void currentLightness;\n    return token;\n  }\n\n  /**\n   * Ajusta saturación de un token.\n   */\n  private adjustChroma(\n    token: DesignToken,\n    _currentChroma: number,\n    _policy: ChromaPolicy\n  ): DesignToken {\n    // Create adjusted token (simplified)\n    return token;\n  }\n\n  /**\n   * Crea colección corregida.\n   */\n  private createCorrectedCollection(\n    original: TokenCollection,\n    violations: PolicyViolation[]\n  ): TokenCollection {\n    const correctedMap = new Map<string, DesignToken>();\n\n    // Map corrected tokens\n    for (const violation of violations) {\n      if (violation.correctedToken) {\n        correctedMap.set(violation.token.name, violation.correctedToken);\n      }\n    }\n\n    // Collect all tokens (corrected where applicable)\n    const allTokens: DesignToken[] = [];\n    for (const token of original.all()) {\n      allTokens.push(correctedMap.get(token.name) || token);\n    }\n\n    // Create collection with all tokens at once (immutable pattern)\n    return TokenCollection.from(`${original.name}-corrected`, allTokens, original.description);\n  }\n\n  /**\n   * Calcula resumen de cumplimiento.\n   */\n  private calculateSummary(\n    collection: TokenCollection,\n    violations: PolicyViolation[],\n    correctedCount: number\n  ): ApplyPerceptualPolicyOutput['summary'] {\n    const totalTokens = collection.all().length;\n    const errorCount = violations.filter(v => v.severity === 'error').length;\n    const warningCount = violations.filter(v => v.severity === 'warning').length;\n    const violatingTokens = new Set(violations.map(v => v.token.name)).size;\n\n    return {\n      totalTokens,\n      compliantTokens: totalTokens - violatingTokens,\n      warningCount,\n      errorCount,\n      correctedCount,\n      complianceRate: (totalTokens - violatingTokens) / totalTokens,\n    };\n  }\n\n  /**\n   * Genera reporte de texto.\n   */\n  private generateReport(\n    policy: PerceptualPolicy,\n    violations: PolicyViolation[],\n    summary: ApplyPerceptualPolicyOutput['summary']\n  ): string {\n    const lines: string[] = [\n      '═══════════════════════════════════════════════════════════════',\n      `  PERCEPTUAL POLICY REPORT: ${policy.name}`,\n      '═══════════════════════════════════════════════════════════════',\n      '',\n      `Policy Description: ${policy.description || 'N/A'}`,\n      '',\n      '─── SUMMARY ──────────────────────────────────────────────────',\n      `Total Tokens:      ${summary.totalTokens}`,\n      `Compliant Tokens:  ${summary.compliantTokens}`,\n      `Compliance Rate:   ${(summary.complianceRate * 100).toFixed(1)}%`,\n      `Errors:            ${summary.errorCount}`,\n      `Warnings:          ${summary.warningCount}`,\n      `Corrected:         ${summary.correctedCount}`,\n      '',\n    ];\n\n    if (violations.length > 0) {\n      lines.push('─── VIOLATIONS ───────────────────────────────────────────────');\n      for (const v of violations) {\n        lines.push(`[${v.severity.toUpperCase()}] ${v.token.name}`);\n        lines.push(`  Rule: ${v.rule}`);\n        lines.push(`  Actual: ${v.actualValue}`);\n        lines.push(`  Expected: ${v.expectedValue}`);\n        if (v.suggestion) {\n          lines.push(`  Suggestion: ${v.suggestion}`);\n        }\n        lines.push('');\n      }\n    }\n\n    lines.push('═══════════════════════════════════════════════════════════════');\n    return lines.join('\\n');\n  }\n}\n\n// ============================================================================\n// EXPORTS\n// ============================================================================\n\nexport default ApplyPerceptualPolicy;\n","/**\n * @fileoverview ExportDesignTokens Use Case\n *\n * Use case para exportar tokens de diseño a múltiples formatos\n * con soporte para transformaciones, validación y destinos múltiples.\n *\n * @module momoto-ui/application/use-cases/ExportDesignTokens\n * @version 1.0.0\n */\n\nimport type { Result } from '../../domain/types';\nimport { success, failure } from '../../domain/types';\nimport { TokenCollection } from '../../domain/tokens';\nimport type {\n  ExporterPort,\n  ExportFormat,\n  ExportOptions,\n  ExportDestination,\n  ExportResult,\n} from '../ports/outbound/ExporterPort';\nimport type { AuditPort } from '../ports/outbound/AuditPort';\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\n/**\n * Transformación a aplicar antes de exportar.\n */\nexport interface TokenTransformation {\n  /** Tipo de transformación */\n  readonly type:\n    | 'prefix'\n    | 'suffix'\n    | 'rename'\n    | 'filter'\n    | 'map'\n    | 'sort'\n    | 'group';\n  /** Configuración de la transformación */\n  readonly config: Record<string, unknown>;\n}\n\n/**\n * Preset de exportación.\n */\nexport interface ExportPreset {\n  /** Nombre del preset */\n  readonly name: string;\n  /** Formatos a generar */\n  readonly formats: ExportFormat[];\n  /** Destinos */\n  readonly destinations?: ExportDestination[];\n  /** Transformaciones a aplicar */\n  readonly transformations?: TokenTransformation[];\n  /** Opciones específicas por formato */\n  readonly formatOptions?: Partial<Record<ExportFormat, Partial<ExportOptions>>>;\n}\n\n/**\n * Input para el use case.\n */\nexport interface ExportDesignTokensInput {\n  /** Colección de tokens a exportar */\n  readonly collection: TokenCollection;\n  /** Formatos de exportación */\n  readonly formats: ExportFormat[];\n  /** Destinos de exportación */\n  readonly destinations?: ExportDestination[];\n  /** Transformaciones a aplicar */\n  readonly transformations?: TokenTransformation[];\n  /** Opciones de exportación */\n  readonly options?: Partial<ExportOptions>;\n  /** Opciones específicas por formato */\n  readonly formatOptions?: Partial<Record<ExportFormat, Partial<ExportOptions>>>;\n  /** Si validar antes de exportar */\n  readonly validateBeforeExport?: boolean;\n  /** Si generar manifest */\n  readonly generateManifest?: boolean;\n  /** Preset a usar */\n  readonly preset?: string;\n}\n\n/**\n * Resultado individual de exportación.\n */\nexport interface FormatExportResult {\n  /** Formato */\n  readonly format: ExportFormat;\n  /** Si tuvo éxito */\n  readonly success: boolean;\n  /** Resultado si éxito */\n  readonly result?: ExportResult;\n  /** Error si falló */\n  readonly error?: Error;\n  /** Destinos a los que se exportó */\n  readonly destinations?: Array<{\n    type: ExportDestination['type'];\n    location?: string;\n    success: boolean;\n    error?: string;\n  }>;\n}\n\n/**\n * Manifest de exportación.\n */\nexport interface ExportManifest {\n  /** Timestamp de exportación */\n  readonly exportedAt: Date;\n  /** Versión del exportador */\n  readonly version: string;\n  /** Nombre de la colección */\n  readonly collectionName: string;\n  /** Total de tokens */\n  readonly tokenCount: number;\n  /** Formatos generados */\n  readonly formats: ExportFormat[];\n  /** Destinos */\n  readonly destinations: string[];\n  /** Checksum del contenido */\n  readonly checksum: string;\n  /** Metadata adicional */\n  readonly metadata?: Record<string, unknown>;\n}\n\n/**\n * Output del use case.\n */\nexport interface ExportDesignTokensOutput {\n  /** Si todas las exportaciones fueron exitosas */\n  readonly success: boolean;\n  /** Resultados por formato */\n  readonly results: FormatExportResult[];\n  /** Manifest si se solicitó */\n  readonly manifest?: ExportManifest;\n  /** Resumen */\n  readonly summary: {\n    readonly totalFormats: number;\n    readonly successfulFormats: number;\n    readonly failedFormats: number;\n    readonly totalDestinations: number;\n    readonly successfulDestinations: number;\n    readonly totalTokensExported: number;\n    readonly totalSizeBytes: number;\n    readonly executionTimeMs: number;\n  };\n  /** Warnings */\n  readonly warnings: string[];\n}\n\n// ============================================================================\n// PRESET CONFIGURATIONS\n// ============================================================================\n\n/**\n * Presets de exportación predefinidos.\n */\nexport const EXPORT_PRESETS: Record<string, ExportPreset> = {\n  /** Preset para desarrollo web */\n  web: {\n    name: 'Web Development',\n    formats: ['css', 'scss', 'typescript'],\n    formatOptions: {\n      css: { rootSelector: ':root', includeFallbacks: true } as Partial<ExportOptions>,\n      scss: { generateMaps: true, generateMixins: true } as Partial<ExportOptions>,\n      typescript: { generateTypes: true, constAssertions: true } as Partial<ExportOptions>,\n    },\n  },\n\n  /** Preset para Tailwind */\n  tailwind: {\n    name: 'Tailwind CSS',\n    formats: ['tailwind', 'css'],\n    formatOptions: {\n      tailwind: {\n        mode: 'extend',\n        sections: ['colors', 'spacing', 'fontSize', 'boxShadow', 'borderRadius'],\n        generatePlugin: true,\n      } as Partial<ExportOptions>,\n    },\n  },\n\n  /** Preset para design tools */\n  designTools: {\n    name: 'Design Tools',\n    formats: ['w3c', 'figma', 'json'],\n    formatOptions: {\n      w3c: { specVersion: '1.0', includeExtensions: true } as Partial<ExportOptions>,\n    },\n  },\n\n  /** Preset para apps nativas */\n  native: {\n    name: 'Native Apps',\n    formats: ['swift', 'kotlin', 'android-xml'],\n  },\n\n  /** Preset para CI/CD */\n  ci: {\n    name: 'CI/CD Pipeline',\n    formats: ['json', 'w3c'],\n    transformations: [\n      { type: 'sort', config: { by: 'name' } },\n    ],\n  },\n\n  /** Preset completo */\n  full: {\n    name: 'Full Export',\n    formats: ['css', 'scss', 'tailwind', 'w3c', 'json', 'typescript'],\n  },\n};\n\n// ============================================================================\n// USE CASE\n// ============================================================================\n\n/**\n * ExportDesignTokens - Exporta tokens de diseño a múltiples formatos.\n *\n * Este use case orquesta la exportación de tokens a diferentes formatos\n * y destinos, aplicando transformaciones y validaciones.\n *\n * @example\n * ```typescript\n * const useCase = new ExportDesignTokens(exporter, auditService);\n *\n * const result = await useCase.execute({\n *   collection: tokenCollection,\n *   formats: ['css', 'tailwind', 'w3c'],\n *   destinations: [\n *     { type: 'file', path: './tokens' },\n *   ],\n *   validateBeforeExport: true,\n *   generateManifest: true,\n * });\n *\n * if (result.success) {\n *   console.log(`Exported ${result.value.summary.totalTokensExported} tokens`);\n *   console.log(`Total size: ${result.value.summary.totalSizeBytes} bytes`);\n * }\n * ```\n */\nexport class ExportDesignTokens {\n  // ─────────────────────────────────────────────────────────────────────────\n  // DEPENDENCIES\n  // ─────────────────────────────────────────────────────────────────────────\n\n  private readonly exporterPort: ExporterPort;\n  private readonly auditPort?: AuditPort;\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // CONSTRUCTOR\n  // ─────────────────────────────────────────────────────────────────────────\n\n  constructor(exporterPort: ExporterPort, auditPort?: AuditPort) {\n    this.exporterPort = exporterPort;\n    this.auditPort = auditPort;\n  }\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // EXECUTION\n  // ─────────────────────────────────────────────────────────────────────────\n\n  /**\n   * Ejecuta el use case.\n   */\n  async execute(\n    input: ExportDesignTokensInput\n  ): Promise<Result<ExportDesignTokensOutput, Error>> {\n    const startTime = Date.now();\n\n    try {\n      // 1. Resolver preset si se especifica\n      const resolvedInput = this.resolvePreset(input);\n\n      // 2. Validar input\n      const validationResult = this.validateInput(resolvedInput);\n      if (!validationResult.success) {\n        return failure(validationResult.error);\n      }\n\n      // 3. Aplicar transformaciones\n      const transformedCollection = await this.applyTransformations(\n        resolvedInput.collection,\n        resolvedInput.transformations\n      );\n\n      // 4. Validar colección si se solicita\n      if (resolvedInput.validateBeforeExport) {\n        const collectionValidation = transformedCollection.validate();\n        if (!collectionValidation.valid) {\n          return failure(\n            new Error(`Token collection validation failed: ${collectionValidation.errors.join(', ')}`)\n          );\n        }\n      }\n\n      // 5. Exportar a cada formato\n      const results: FormatExportResult[] = [];\n      const warnings: string[] = [];\n\n      for (const format of resolvedInput.formats) {\n        const formatResult = await this.exportFormat(\n          transformedCollection,\n          format,\n          resolvedInput\n        );\n        results.push(formatResult);\n\n        if (!formatResult.success && formatResult.error) {\n          warnings.push(`Format ${format}: ${formatResult.error.message}`);\n        }\n      }\n\n      // 6. Calcular resumen\n      const summary = this.calculateSummary(results, startTime);\n\n      // 7. Generar manifest si se solicita\n      let manifest: ExportManifest | undefined;\n      if (resolvedInput.generateManifest) {\n        manifest = this.generateManifest(transformedCollection, resolvedInput.formats, results);\n      }\n\n      // 8. Registrar en auditoría\n      if (this.auditPort) {\n        await this.auditPort.log({\n          category: 'export',\n          severity: summary.failedFormats > 0 ? 'warning' : 'info',\n          message: `Exported ${summary.totalTokensExported} tokens to ${summary.successfulFormats} formats`,\n          data: {\n            formats: resolvedInput.formats,\n            tokenCount: summary.totalTokensExported,\n            sizeBytes: summary.totalSizeBytes,\n            executionTimeMs: summary.executionTimeMs,\n          },\n        });\n      }\n\n      return success({\n        success: summary.failedFormats === 0,\n        results,\n        manifest,\n        summary,\n        warnings,\n      });\n    } catch (error) {\n      return failure(\n        error instanceof Error ? error : new Error('Unknown error during token export')\n      );\n    }\n  }\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // PRIVATE METHODS\n  // ─────────────────────────────────────────────────────────────────────────\n\n  /**\n   * Resuelve preset si se especifica.\n   */\n  private resolvePreset(input: ExportDesignTokensInput): ExportDesignTokensInput {\n    if (!input.preset || !EXPORT_PRESETS[input.preset]) {\n      return input;\n    }\n\n    const preset = EXPORT_PRESETS[input.preset];\n    return {\n      ...input,\n      formats: input.formats.length > 0 ? input.formats : preset.formats,\n      destinations: input.destinations || preset.destinations,\n      transformations: [...(preset.transformations || []), ...(input.transformations || [])],\n      formatOptions: { ...preset.formatOptions, ...input.formatOptions },\n    };\n  }\n\n  /**\n   * Valida el input.\n   */\n  private validateInput(input: ExportDesignTokensInput): Result<void, Error> {\n    if (!input.collection) {\n      return failure(new Error('Token collection is required'));\n    }\n\n    if (!input.formats || input.formats.length === 0) {\n      return failure(new Error('At least one export format is required'));\n    }\n\n    for (const format of input.formats) {\n      if (!this.exporterPort.supportsFormat(format)) {\n        return failure(new Error(`Unsupported export format: ${format}`));\n      }\n    }\n\n    return success(undefined);\n  }\n\n  /**\n   * Aplica transformaciones a la colección.\n   */\n  private async applyTransformations(\n    collection: TokenCollection,\n    transformations?: TokenTransformation[]\n  ): Promise<TokenCollection> {\n    if (!transformations || transformations.length === 0) {\n      return collection;\n    }\n\n    let result = collection;\n\n    for (const transform of transformations) {\n      result = this.applyTransformation(result, transform);\n    }\n\n    return result;\n  }\n\n  /**\n   * Aplica una transformación individual.\n   */\n  private applyTransformation(\n    collection: TokenCollection,\n    transform: TokenTransformation\n  ): TokenCollection {\n    switch (transform.type) {\n      case 'filter':\n        return this.applyFilterTransform(collection, transform.config);\n      case 'sort':\n        return this.applySortTransform(collection, transform.config);\n      default:\n        return collection;\n    }\n  }\n\n  /**\n   * Aplica transformación de filtro.\n   */\n  private applyFilterTransform(\n    collection: TokenCollection,\n    config: Record<string, unknown>\n  ): TokenCollection {\n    const tokens = collection.filter(config as Parameters<typeof collection.filter>[0]);\n    // Use from() to create collection with filtered tokens (immutable pattern)\n    return TokenCollection.from(`${collection.name}-filtered`, [...tokens], collection.description);\n  }\n\n  /**\n   * Aplica transformación de ordenamiento.\n   */\n  private applySortTransform(\n    collection: TokenCollection,\n    _config: Record<string, unknown>\n  ): TokenCollection {\n    // Simplified - would implement actual sorting based on config\n    return collection;\n  }\n\n  /**\n   * Exporta a un formato específico.\n   */\n  private async exportFormat(\n    collection: TokenCollection,\n    format: ExportFormat,\n    input: ExportDesignTokensInput\n  ): Promise<FormatExportResult> {\n    try {\n      const options = this.buildExportOptions(format, input);\n      const exportResult = await this.exporterPort.export(collection, options);\n\n      if (!exportResult.success) {\n        return {\n          format,\n          success: false,\n          error: exportResult.error,\n        };\n      }\n\n      // Export to destinations if specified\n      const destinations = input.destinations || [];\n      const destinationResults: FormatExportResult['destinations'] = [];\n\n      for (const dest of destinations) {\n        try {\n          const destResult = await this.exporterPort.exportTo(collection, options, dest);\n          destinationResults.push({\n            type: dest.type,\n            location: destResult.success ? destResult.value.location : undefined,\n            success: destResult.success,\n            error: destResult.success ? undefined : destResult.error.message,\n          });\n        } catch (e) {\n          destinationResults.push({\n            type: dest.type,\n            success: false,\n            error: e instanceof Error ? e.message : 'Unknown error',\n          });\n        }\n      }\n\n      return {\n        format,\n        success: true,\n        result: exportResult.value,\n        destinations: destinationResults.length > 0 ? destinationResults : undefined,\n      };\n    } catch (error) {\n      return {\n        format,\n        success: false,\n        error: error instanceof Error ? error : new Error('Unknown export error'),\n      };\n    }\n  }\n\n  /**\n   * Construye opciones de exportación.\n   */\n  private buildExportOptions(\n    format: ExportFormat,\n    input: ExportDesignTokensInput\n  ): ExportOptions {\n    const baseOptions = input.options || {};\n    const formatSpecificOptions = input.formatOptions?.[format] || {};\n\n    return {\n      format,\n      ...baseOptions,\n      ...formatSpecificOptions,\n    } as ExportOptions;\n  }\n\n  /**\n   * Calcula resumen de exportación.\n   */\n  private calculateSummary(\n    results: FormatExportResult[],\n    startTime: number\n  ): ExportDesignTokensOutput['summary'] {\n    const successfulFormats = results.filter(r => r.success).length;\n    const failedFormats = results.length - successfulFormats;\n\n    const totalTokensExported = results\n      .filter(r => r.success && r.result)\n      .reduce((sum, r) => sum + (r.result?.tokenCount || 0), 0) / Math.max(successfulFormats, 1);\n\n    const totalSizeBytes = results\n      .filter(r => r.success && r.result)\n      .reduce((sum, r) => sum + (r.result?.sizeBytes || 0), 0);\n\n    const destinations = results.flatMap(r => r.destinations || []);\n    const successfulDestinations = destinations.filter(d => d.success).length;\n\n    return {\n      totalFormats: results.length,\n      successfulFormats,\n      failedFormats,\n      totalDestinations: destinations.length,\n      successfulDestinations,\n      totalTokensExported: Math.round(totalTokensExported),\n      totalSizeBytes,\n      executionTimeMs: Date.now() - startTime,\n    };\n  }\n\n  /**\n   * Genera manifest de exportación.\n   */\n  private generateManifest(\n    collection: TokenCollection,\n    formats: ExportFormat[],\n    results: FormatExportResult[]\n  ): ExportManifest {\n    const destinations = results\n      .flatMap(r => r.destinations || [])\n      .filter(d => d.success && d.location)\n      .map(d => d.location!);\n\n    return {\n      exportedAt: new Date(),\n      version: '1.0.0',\n      collectionName: collection.name,\n      tokenCount: collection.all().length,\n      formats,\n      destinations,\n      checksum: this.generateChecksum(collection),\n    };\n  }\n\n  /**\n   * Genera checksum de la colección.\n   */\n  private generateChecksum(collection: TokenCollection): string {\n    // Simplified checksum - would use proper hashing\n    const content = collection.export({ format: 'json' });\n    let hash = 0;\n    for (let i = 0; i < content.length; i++) {\n      const char = content.charCodeAt(i);\n      hash = ((hash << 5) - hash) + char;\n      hash = hash & hash;\n    }\n    return Math.abs(hash).toString(16).padStart(8, '0');\n  }\n}\n\n// ============================================================================\n// EXPORTS\n// ============================================================================\n\nexport default ExportDesignTokens;\n","/**\n * @fileoverview AuditVisualDecisions Use Case\n *\n * Use case para auditar decisiones visuales del sistema, generando\n * reportes de trazabilidad, cumplimiento y métricas de calidad.\n *\n * @module momoto-ui/application/use-cases/AuditVisualDecisions\n * @version 1.0.0\n */\n\nimport type { Result } from '../../domain/types';\nimport { success, failure } from '../../domain/types';\nimport { TokenCollection } from '../../domain/tokens';\nimport type {\n  AuditPort,\n  AuditFilter,\n  AuditSeverity,\n} from '../ports/outbound/AuditPort';\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\n/**\n * Tipo de auditoría a ejecutar.\n */\nexport type AuditType =\n  | 'accessibility'\n  | 'color-decisions'\n  | 'token-usage'\n  | 'performance'\n  | 'compliance'\n  | 'full';\n\n/**\n * Nivel de detalle del reporte.\n */\nexport type ReportDetail = 'summary' | 'standard' | 'detailed' | 'verbose';\n\n/**\n * Formato de salida del reporte.\n */\nexport type ReportFormat = 'text' | 'json' | 'html' | 'markdown' | 'csv';\n\n/**\n * Configuración de auditoría de accesibilidad.\n */\nexport interface AccessibilityAuditConfig {\n  /** Nivel WCAG mínimo */\n  readonly wcagLevel: 'A' | 'AA' | 'AAA';\n  /** Si evaluar APCA */\n  readonly evaluateApca: boolean;\n  /** Nivel APCA mínimo */\n  readonly apcaMinLevel: number;\n  /** Componentes a auditar */\n  readonly components?: string[];\n  /** Si incluir recomendaciones */\n  readonly includeRecommendations: boolean;\n}\n\n/**\n * Configuración de auditoría de decisiones de color.\n */\nexport interface ColorDecisionAuditConfig {\n  /** Si auditar consistencia */\n  readonly auditConsistency: boolean;\n  /** Si auditar armonía */\n  readonly auditHarmony: boolean;\n  /** Tolerancia de variación */\n  readonly varianceTolerance: number;\n  /** Período a auditar */\n  readonly period?: {\n    readonly start: Date;\n    readonly end: Date;\n  };\n}\n\n/**\n * Configuración de auditoría de uso de tokens.\n */\nexport interface TokenUsageAuditConfig {\n  /** Colección de referencia */\n  readonly referenceCollection?: TokenCollection;\n  /** Si detectar tokens no usados */\n  readonly detectUnused: boolean;\n  /** Si detectar tokens duplicados */\n  readonly detectDuplicates: boolean;\n  /** Si detectar tokens sin categorizar */\n  readonly detectUncategorized: boolean;\n}\n\n/**\n * Configuración de auditoría de rendimiento.\n */\nexport interface PerformanceAuditConfig {\n  /** Umbral de tiempo de generación (ms) */\n  readonly generationTimeThreshold: number;\n  /** Umbral de tamaño de colección */\n  readonly collectionSizeThreshold: number;\n  /** Si auditar memoria */\n  readonly auditMemory: boolean;\n}\n\n/**\n * Input para el use case.\n */\nexport interface AuditVisualDecisionsInput {\n  /** Tipos de auditoría a ejecutar */\n  readonly auditTypes: AuditType[];\n  /** Colección de tokens a auditar */\n  readonly tokenCollection?: TokenCollection;\n  /** Nivel de detalle del reporte */\n  readonly detailLevel: ReportDetail;\n  /** Formato de salida */\n  readonly outputFormat: ReportFormat;\n  /** Configuración de accesibilidad */\n  readonly accessibilityConfig?: AccessibilityAuditConfig;\n  /** Configuración de decisiones de color */\n  readonly colorDecisionConfig?: ColorDecisionAuditConfig;\n  /** Configuración de uso de tokens */\n  readonly tokenUsageConfig?: TokenUsageAuditConfig;\n  /** Configuración de rendimiento */\n  readonly performanceConfig?: PerformanceAuditConfig;\n  /** Filtros de período */\n  readonly periodFilter?: {\n    readonly start: Date;\n    readonly end: Date;\n  };\n  /** Si incluir datos históricos */\n  readonly includeHistory: boolean;\n}\n\n/**\n * Resultado de auditoría de accesibilidad.\n */\nexport interface AccessibilityAuditResult {\n  /** Total de evaluaciones */\n  readonly totalEvaluations: number;\n  /** Evaluaciones que pasan */\n  readonly passing: number;\n  /** Evaluaciones que fallan */\n  readonly failing: number;\n  /** Tasa de cumplimiento */\n  readonly complianceRate: number;\n  /** Componentes con issues */\n  readonly issueComponents: Array<{\n    readonly component: string;\n    readonly issue: string;\n    readonly severity: AuditSeverity;\n    readonly recommendation?: string;\n  }>;\n  /** Ratio WCAG promedio */\n  readonly avgWcagRatio: number;\n  /** Nivel APCA promedio */\n  readonly avgApcaLevel: number;\n}\n\n/**\n * Resultado de auditoría de decisiones de color.\n */\nexport interface ColorDecisionAuditResult {\n  /** Total de decisiones */\n  readonly totalDecisions: number;\n  /** Decisiones consistentes */\n  readonly consistentDecisions: number;\n  /** Variaciones detectadas */\n  readonly variations: Array<{\n    readonly context: string;\n    readonly expected: string;\n    readonly actual: string;\n    readonly deviation: number;\n  }>;\n  /** Score de armonía */\n  readonly harmonyScore: number;\n  /** Paleta efectiva extraída */\n  readonly effectivePalette: string[];\n}\n\n/**\n * Resultado de auditoría de uso de tokens.\n */\nexport interface TokenUsageAuditResult {\n  /** Total de tokens */\n  readonly totalTokens: number;\n  /** Tokens usados */\n  readonly usedTokens: number;\n  /** Tokens no usados */\n  readonly unusedTokens: string[];\n  /** Tokens duplicados */\n  readonly duplicateTokens: Array<{\n    readonly name: string;\n    readonly duplicateOf: string;\n  }>;\n  /** Tokens sin categorizar */\n  readonly uncategorizedTokens: string[];\n  /** Cobertura de uso */\n  readonly usageCoverage: number;\n}\n\n/**\n * Resultado de auditoría de rendimiento.\n */\nexport interface PerformanceAuditResult {\n  /** Tiempo promedio de generación */\n  readonly avgGenerationTimeMs: number;\n  /** Tiempo máximo de generación */\n  readonly maxGenerationTimeMs: number;\n  /** Operaciones lentas */\n  readonly slowOperations: Array<{\n    readonly operation: string;\n    readonly timeMs: number;\n    readonly threshold: number;\n  }>;\n  /** Tamaño de colección */\n  readonly collectionSizeBytes: number;\n  /** Score de rendimiento */\n  readonly performanceScore: number;\n}\n\n/**\n * Score general de calidad.\n */\nexport interface QualityScore {\n  /** Score total (0-100) */\n  readonly overall: number;\n  /** Score por categoría */\n  readonly byCategory: {\n    readonly accessibility: number;\n    readonly consistency: number;\n    readonly coverage: number;\n    readonly performance: number;\n  };\n  /** Grade (A-F) */\n  readonly grade: 'A' | 'B' | 'C' | 'D' | 'F';\n  /** Áreas de mejora */\n  readonly improvementAreas: string[];\n}\n\n/**\n * Output del use case.\n */\nexport interface AuditVisualDecisionsOutput {\n  /** Resultado de accesibilidad */\n  readonly accessibility?: AccessibilityAuditResult;\n  /** Resultado de decisiones de color */\n  readonly colorDecisions?: ColorDecisionAuditResult;\n  /** Resultado de uso de tokens */\n  readonly tokenUsage?: TokenUsageAuditResult;\n  /** Resultado de rendimiento */\n  readonly performance?: PerformanceAuditResult;\n  /** Score de calidad general */\n  readonly qualityScore: QualityScore;\n  /** Reporte formateado */\n  readonly report: string;\n  /** Resumen ejecutivo */\n  readonly executiveSummary: string;\n  /** Recomendaciones priorizadas */\n  readonly recommendations: Array<{\n    readonly priority: 'high' | 'medium' | 'low';\n    readonly category: string;\n    readonly recommendation: string;\n    readonly impact: string;\n  }>;\n  /** Metadata de la auditoría */\n  readonly metadata: {\n    readonly auditedAt: Date;\n    readonly duration: number;\n    readonly auditTypes: AuditType[];\n    readonly periodCovered?: { start: Date; end: Date };\n  };\n}\n\n// ============================================================================\n// USE CASE\n// ============================================================================\n\n/**\n * AuditVisualDecisions - Audita decisiones visuales del sistema.\n *\n * Este use case genera reportes comprehensivos sobre la calidad\n * de las decisiones visuales, accesibilidad y uso de tokens.\n *\n * @example\n * ```typescript\n * const useCase = new AuditVisualDecisions(auditPort);\n *\n * const result = await useCase.execute({\n *   auditTypes: ['accessibility', 'color-decisions', 'token-usage'],\n *   tokenCollection: myTokens,\n *   detailLevel: 'detailed',\n *   outputFormat: 'markdown',\n *   accessibilityConfig: {\n *     wcagLevel: 'AA',\n *     evaluateApca: true,\n *     apcaMinLevel: 60,\n *     includeRecommendations: true,\n *   },\n *   includeHistory: true,\n * });\n *\n * if (result.success) {\n *   console.log(`Quality Score: ${result.value.qualityScore.overall}/100`);\n *   console.log(`Grade: ${result.value.qualityScore.grade}`);\n *   console.log(result.value.report);\n * }\n * ```\n */\nexport class AuditVisualDecisions {\n  // ─────────────────────────────────────────────────────────────────────────\n  // DEPENDENCIES\n  // ─────────────────────────────────────────────────────────────────────────\n\n  private readonly auditPort: AuditPort;\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // CONSTRUCTOR\n  // ─────────────────────────────────────────────────────────────────────────\n\n  constructor(auditPort: AuditPort) {\n    this.auditPort = auditPort;\n  }\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // EXECUTION\n  // ─────────────────────────────────────────────────────────────────────────\n\n  /**\n   * Ejecuta el use case.\n   */\n  async execute(\n    input: AuditVisualDecisionsInput\n  ): Promise<Result<AuditVisualDecisionsOutput, Error>> {\n    const startTime = Date.now();\n\n    try {\n      // Validar input\n      const validationResult = this.validateInput(input);\n      if (!validationResult.success) {\n        return failure(validationResult.error);\n      }\n\n      // Resolver 'full' a todos los tipos\n      const auditTypes = input.auditTypes.includes('full')\n        ? ['accessibility', 'color-decisions', 'token-usage', 'performance'] as AuditType[]\n        : input.auditTypes;\n\n      // Ejecutar auditorías\n      let accessibility: AccessibilityAuditResult | undefined;\n      let colorDecisions: ColorDecisionAuditResult | undefined;\n      let tokenUsage: TokenUsageAuditResult | undefined;\n      let performance: PerformanceAuditResult | undefined;\n\n      if (auditTypes.includes('accessibility')) {\n        accessibility = await this.auditAccessibility(input);\n      }\n\n      if (auditTypes.includes('color-decisions')) {\n        colorDecisions = await this.auditColorDecisions(input);\n      }\n\n      if (auditTypes.includes('token-usage') && input.tokenCollection) {\n        tokenUsage = await this.auditTokenUsage(input);\n      }\n\n      if (auditTypes.includes('performance')) {\n        performance = await this.auditPerformance(input);\n      }\n\n      // Calcular score de calidad\n      const qualityScore = this.calculateQualityScore(\n        accessibility,\n        colorDecisions,\n        tokenUsage,\n        performance\n      );\n\n      // Generar recomendaciones\n      const recommendations = this.generateRecommendations(\n        accessibility,\n        colorDecisions,\n        tokenUsage,\n        performance\n      );\n\n      // Generar reportes\n      const report = this.generateReport(input, {\n        accessibility,\n        colorDecisions,\n        tokenUsage,\n        performance,\n        qualityScore,\n        recommendations,\n      });\n\n      const executiveSummary = this.generateExecutiveSummary(qualityScore, recommendations);\n\n      // Registrar auditoría\n      await this.auditPort.log({\n        category: 'validation',\n        severity: qualityScore.overall < 70 ? 'warning' : 'info',\n        message: `Visual decisions audit completed with score ${qualityScore.overall}/100 (${qualityScore.grade})`,\n        data: {\n          score: qualityScore.overall,\n          grade: qualityScore.grade,\n          auditTypes,\n          duration: Date.now() - startTime,\n        },\n      });\n\n      return success({\n        accessibility,\n        colorDecisions,\n        tokenUsage,\n        performance,\n        qualityScore,\n        report,\n        executiveSummary,\n        recommendations,\n        metadata: {\n          auditedAt: new Date(),\n          duration: Date.now() - startTime,\n          auditTypes,\n          periodCovered: input.periodFilter,\n        },\n      });\n    } catch (error) {\n      return failure(\n        error instanceof Error ? error : new Error('Unknown error during audit')\n      );\n    }\n  }\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // PRIVATE METHODS\n  // ─────────────────────────────────────────────────────────────────────────\n\n  /**\n   * Valida el input.\n   */\n  private validateInput(input: AuditVisualDecisionsInput): Result<void, Error> {\n    if (!input.auditTypes || input.auditTypes.length === 0) {\n      return failure(new Error('At least one audit type is required'));\n    }\n\n    if (input.auditTypes.includes('token-usage') && !input.tokenCollection) {\n      return failure(new Error('Token collection is required for token-usage audit'));\n    }\n\n    return success(undefined);\n  }\n\n  /**\n   * Audita accesibilidad.\n   */\n  private async auditAccessibility(\n    input: AuditVisualDecisionsInput\n  ): Promise<AccessibilityAuditResult> {\n    const filter: AuditFilter = {\n      categories: ['accessibility'],\n      startDate: input.periodFilter?.start,\n      endDate: input.periodFilter?.end,\n    };\n\n    const entriesResult = await this.auditPort.query(filter);\n    const entries = entriesResult.success ? entriesResult.value : [];\n\n    const passing = entries.filter(e => (e.data as Record<string, unknown>)?.passes === true).length;\n    const failing = entries.length - passing;\n\n    const issueComponents = entries\n      .filter(e => (e.data as Record<string, unknown>)?.passes === false)\n      .map(e => ({\n        component: String((e.data as Record<string, unknown>)?.component || 'Unknown'),\n        issue: e.message,\n        severity: e.severity,\n        recommendation: String((e.data as Record<string, unknown>)?.recommendation || ''),\n      }));\n\n    const wcagRatios = entries\n      .map(e => Number((e.data as Record<string, unknown>)?.wcagRatio || 0))\n      .filter(r => r > 0);\n    const avgWcagRatio = wcagRatios.length > 0\n      ? wcagRatios.reduce((a, b) => a + b, 0) / wcagRatios.length\n      : 0;\n\n    const apcaLevels = entries\n      .map(e => Number((e.data as Record<string, unknown>)?.apcaLevel || 0))\n      .filter(l => l > 0);\n    const avgApcaLevel = apcaLevels.length > 0\n      ? apcaLevels.reduce((a, b) => a + b, 0) / apcaLevels.length\n      : 0;\n\n    return {\n      totalEvaluations: entries.length,\n      passing,\n      failing,\n      complianceRate: entries.length > 0 ? passing / entries.length : 1,\n      issueComponents,\n      avgWcagRatio,\n      avgApcaLevel,\n    };\n  }\n\n  /**\n   * Audita decisiones de color.\n   */\n  private async auditColorDecisions(\n    input: AuditVisualDecisionsInput\n  ): Promise<ColorDecisionAuditResult> {\n    const filter: AuditFilter = {\n      categories: ['color-decision'],\n      startDate: input.periodFilter?.start,\n      endDate: input.periodFilter?.end,\n    };\n\n    const entriesResult = await this.auditPort.query(filter);\n    const entries = entriesResult.success ? entriesResult.value : [];\n\n    // Extract effective palette from decisions\n    const colors = new Set<string>();\n    for (const entry of entries) {\n      const data = entry.data as Record<string, unknown>;\n      if (data?.outputColor) {\n        colors.add(String(data.outputColor));\n      }\n    }\n\n    return {\n      totalDecisions: entries.length,\n      consistentDecisions: entries.length, // Simplified\n      variations: [],\n      harmonyScore: 85, // Simplified\n      effectivePalette: Array.from(colors).slice(0, 10),\n    };\n  }\n\n  /**\n   * Audita uso de tokens.\n   */\n  private async auditTokenUsage(\n    input: AuditVisualDecisionsInput\n  ): Promise<TokenUsageAuditResult> {\n    const collection = input.tokenCollection!;\n    const allTokens = collection.all();\n\n    // Detect duplicates by value\n    const valueMap = new Map<string, string[]>();\n    for (const token of allTokens) {\n      const value = token.toCssVariable();\n      const existing = valueMap.get(value) || [];\n      existing.push(token.name);\n      valueMap.set(value, existing);\n    }\n\n    const duplicates = Array.from(valueMap.entries())\n      .filter(([, names]) => names.length > 1)\n      .map(([, names]) => ({\n        name: names[0],\n        duplicateOf: names.slice(1).join(', '),\n      }));\n\n    // Detect uncategorized\n    const uncategorized = allTokens\n      .filter(t => !t.context?.component && !t.context?.intent)\n      .map(t => t.name);\n\n    return {\n      totalTokens: allTokens.length,\n      usedTokens: allTokens.length - uncategorized.length,\n      unusedTokens: [], // Would need actual usage tracking\n      duplicateTokens: duplicates,\n      uncategorizedTokens: uncategorized,\n      usageCoverage: 1 - (uncategorized.length / allTokens.length),\n    };\n  }\n\n  /**\n   * Audita rendimiento.\n   */\n  private async auditPerformance(\n    input: AuditVisualDecisionsInput\n  ): Promise<PerformanceAuditResult> {\n    const filter: AuditFilter = {\n      categories: ['token-generation', 'performance'],\n      startDate: input.periodFilter?.start,\n      endDate: input.periodFilter?.end,\n    };\n\n    const entriesResult = await this.auditPort.query(filter);\n    const entries = entriesResult.success ? entriesResult.value : [];\n\n    const times = entries\n      .map(e => Number((e.data as Record<string, unknown>)?.generationTimeMs || 0))\n      .filter(t => t > 0);\n\n    const avgTime = times.length > 0 ? times.reduce((a, b) => a + b, 0) / times.length : 0;\n    const maxTime = times.length > 0 ? Math.max(...times) : 0;\n\n    const threshold = input.performanceConfig?.generationTimeThreshold || 100;\n    const slowOperations = entries\n      .filter(e => Number((e.data as Record<string, unknown>)?.generationTimeMs || 0) > threshold)\n      .map(e => ({\n        operation: e.message,\n        timeMs: Number((e.data as Record<string, unknown>)?.generationTimeMs || 0),\n        threshold,\n      }));\n\n    return {\n      avgGenerationTimeMs: avgTime,\n      maxGenerationTimeMs: maxTime,\n      slowOperations,\n      collectionSizeBytes: input.tokenCollection\n        ? Buffer.byteLength(input.tokenCollection.export({ format: 'json' }))\n        : 0,\n      performanceScore: Math.max(0, 100 - (slowOperations.length * 10)),\n    };\n  }\n\n  /**\n   * Calcula score de calidad.\n   */\n  private calculateQualityScore(\n    accessibility?: AccessibilityAuditResult,\n    colorDecisions?: ColorDecisionAuditResult,\n    tokenUsage?: TokenUsageAuditResult,\n    performance?: PerformanceAuditResult\n  ): QualityScore {\n    const scores = {\n      accessibility: accessibility ? accessibility.complianceRate * 100 : 100,\n      consistency: colorDecisions ? colorDecisions.harmonyScore : 100,\n      coverage: tokenUsage ? tokenUsage.usageCoverage * 100 : 100,\n      performance: performance ? performance.performanceScore : 100,\n    };\n\n    const overall = Object.values(scores).reduce((a, b) => a + b, 0) / 4;\n\n    const improvementAreas: string[] = [];\n    if (scores.accessibility < 80) improvementAreas.push('Accessibility compliance');\n    if (scores.consistency < 80) improvementAreas.push('Color consistency');\n    if (scores.coverage < 80) improvementAreas.push('Token coverage');\n    if (scores.performance < 80) improvementAreas.push('Performance optimization');\n\n    return {\n      overall: Math.round(overall),\n      byCategory: scores,\n      grade: this.calculateGrade(overall),\n      improvementAreas,\n    };\n  }\n\n  /**\n   * Calcula grade basado en score.\n   */\n  private calculateGrade(score: number): 'A' | 'B' | 'C' | 'D' | 'F' {\n    if (score >= 90) return 'A';\n    if (score >= 80) return 'B';\n    if (score >= 70) return 'C';\n    if (score >= 60) return 'D';\n    return 'F';\n  }\n\n  /**\n   * Genera recomendaciones.\n   */\n  private generateRecommendations(\n    accessibility?: AccessibilityAuditResult,\n    colorDecisions?: ColorDecisionAuditResult,\n    tokenUsage?: TokenUsageAuditResult,\n    performance?: PerformanceAuditResult\n  ): AuditVisualDecisionsOutput['recommendations'] {\n    const recommendations: AuditVisualDecisionsOutput['recommendations'] = [];\n\n    if (accessibility && accessibility.complianceRate < 1) {\n      recommendations.push({\n        priority: 'high',\n        category: 'Accessibility',\n        recommendation: `Fix ${accessibility.failing} accessibility violations`,\n        impact: 'Critical for users with disabilities and legal compliance',\n      });\n    }\n\n    if (colorDecisions && colorDecisions.variations.length > 0) {\n      recommendations.push({\n        priority: 'medium',\n        category: 'Color Decisions',\n        recommendation: `Review ${colorDecisions.variations.length} color decision variations`,\n        impact: 'Maintains visual consistency and reduces technical debt',\n      });\n    }\n\n    if (tokenUsage && tokenUsage.duplicateTokens.length > 0) {\n      recommendations.push({\n        priority: 'medium',\n        category: 'Token Usage',\n        recommendation: `Consolidate ${tokenUsage.duplicateTokens.length} duplicate tokens`,\n        impact: 'Reduces bundle size and improves maintainability',\n      });\n    }\n\n    if (performance && performance.slowOperations.length > 0) {\n      recommendations.push({\n        priority: 'low',\n        category: 'Performance',\n        recommendation: `Optimize ${performance.slowOperations.length} slow operations`,\n        impact: 'Improves development experience and build times',\n      });\n    }\n\n    return recommendations;\n  }\n\n  /**\n   * Genera reporte formateado.\n   */\n  private generateReport(\n    input: AuditVisualDecisionsInput,\n    data: Partial<AuditVisualDecisionsOutput>\n  ): string {\n    switch (input.outputFormat) {\n      case 'json':\n        return JSON.stringify(data, null, 2);\n      case 'markdown':\n        return this.generateMarkdownReport(data);\n      case 'html':\n        return this.generateHtmlReport(data);\n      default:\n        return this.generateTextReport(data);\n    }\n  }\n\n  /**\n   * Genera reporte en texto.\n   */\n  private generateTextReport(data: Partial<AuditVisualDecisionsOutput>): string {\n    const lines: string[] = [\n      '═══════════════════════════════════════════════════════════════',\n      '           VISUAL DECISIONS AUDIT REPORT',\n      '═══════════════════════════════════════════════════════════════',\n      '',\n      `Quality Score: ${data.qualityScore?.overall}/100 (${data.qualityScore?.grade})`,\n      '',\n    ];\n\n    if (data.qualityScore?.improvementAreas.length) {\n      lines.push('Areas for Improvement:');\n      for (const area of data.qualityScore.improvementAreas) {\n        lines.push(`  • ${area}`);\n      }\n      lines.push('');\n    }\n\n    return lines.join('\\n');\n  }\n\n  /**\n   * Genera reporte en Markdown.\n   */\n  private generateMarkdownReport(data: Partial<AuditVisualDecisionsOutput>): string {\n    return `# Visual Decisions Audit Report\n\n## Quality Score: ${data.qualityScore?.overall}/100 (${data.qualityScore?.grade})\n\n### Scores by Category\n- Accessibility: ${data.qualityScore?.byCategory.accessibility.toFixed(0)}%\n- Consistency: ${data.qualityScore?.byCategory.consistency.toFixed(0)}%\n- Coverage: ${data.qualityScore?.byCategory.coverage.toFixed(0)}%\n- Performance: ${data.qualityScore?.byCategory.performance.toFixed(0)}%\n\n### Recommendations\n${data.recommendations?.map(r => `- **[${r.priority.toUpperCase()}]** ${r.recommendation}`).join('\\n') || 'None'}\n`;\n  }\n\n  /**\n   * Genera reporte en HTML.\n   */\n  private generateHtmlReport(data: Partial<AuditVisualDecisionsOutput>): string {\n    return `<!DOCTYPE html>\n<html>\n<head><title>Audit Report</title></head>\n<body>\n<h1>Visual Decisions Audit Report</h1>\n<h2>Quality Score: ${data.qualityScore?.overall}/100 (${data.qualityScore?.grade})</h2>\n</body>\n</html>`;\n  }\n\n  /**\n   * Genera resumen ejecutivo.\n   */\n  private generateExecutiveSummary(\n    qualityScore: QualityScore,\n    recommendations: AuditVisualDecisionsOutput['recommendations']\n  ): string {\n    const highPriority = recommendations.filter(r => r.priority === 'high').length;\n\n    return `Quality Score: ${qualityScore.overall}/100 (Grade ${qualityScore.grade}). ` +\n      `${highPriority} high-priority issues require attention. ` +\n      `Key improvement areas: ${qualityScore.improvementAreas.join(', ') || 'None'}.`;\n  }\n}\n\n// ============================================================================\n// EXPORTS\n// ============================================================================\n\nexport default AuditVisualDecisions;\n"]}