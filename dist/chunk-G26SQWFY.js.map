{"version":3,"sources":["../infrastructure/audit/InMemoryAuditAdapter.ts"],"names":["__publicField","success","failure"],"mappings":"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","file":"chunk-G26SQWFY.js","sourcesContent":["/**\n * @fileoverview In-Memory Audit Adapter\n *\n * Implementación en memoria del AuditPort para desarrollo y testing.\n * Almacena entradas de auditoría en memoria con capacidad limitada.\n *\n * @module momoto-ui/infrastructure/audit/InMemoryAuditAdapter\n * @version 1.0.0\n */\n\nimport type { Result } from '../../domain/types';\nimport { success, failure } from '../../domain/types';\nimport type {\n  AuditPort,\n  AuditEntry,\n  AuditFilter,\n  AuditReport,\n  AuditStats,\n  AuditCategory,\n  AuditSeverity,\n} from '../../application/ports/outbound/AuditPort';\nimport type { PerceptualColor } from '../../domain/perceptual';\nimport type { DesignToken } from '../../domain/tokens';\nimport type { UIRole, ComponentIntent } from '../../domain/ux';\nimport type { UIState } from '../../domain/types';\n\n// ============================================================================\n// TYPES\n// ============================================================================\n\n/**\n * Opciones de configuración del adaptador.\n */\nexport interface InMemoryAuditOptions {\n  /** Número máximo de entradas a mantener */\n  readonly maxEntries?: number;\n  /** Si habilitar logging a consola */\n  readonly consoleLogging?: boolean;\n  /** Nivel de logging */\n  readonly logLevel?: 'info' | 'warning' | 'error' | 'critical';\n  /** Callback para cada entrada nueva */\n  readonly onEntry?: (entry: AuditEntry) => void;\n}\n\n/**\n * Opciones por defecto.\n */\nconst DEFAULT_OPTIONS: Required<InMemoryAuditOptions> = {\n  maxEntries: 10000,\n  consoleLogging: false,\n  logLevel: 'info',\n  onEntry: () => {},\n};\n\n// ============================================================================\n// ADAPTER\n// ============================================================================\n\n/**\n * InMemoryAuditAdapter - Adaptador de auditoría en memoria.\n *\n * Ideal para:\n * - Desarrollo local\n * - Testing\n * - Debugging\n * - Demos\n *\n * NO recomendado para producción (datos se pierden al reiniciar).\n *\n * @example\n * ```typescript\n * const auditAdapter = new InMemoryAuditAdapter({\n *   maxEntries: 1000,\n *   consoleLogging: true,\n *   logLevel: 'info',\n * });\n *\n * // Log a color decision\n * await auditAdapter.logColorDecision({\n *   inputColor: PerceptualColor.fromHex('#3B82F6'),\n *   outputColor: PerceptualColor.fromHex('#2563EB'),\n *   rationale: 'Adjusted for WCAG AA compliance',\n * });\n * ```\n */\nexport class InMemoryAuditAdapter implements AuditPort {\n  // ─────────────────────────────────────────────────────────────────────────\n  // PROPERTIES\n  // ─────────────────────────────────────────────────────────────────────────\n\n  private readonly options: Required<InMemoryAuditOptions>;\n  private entries: AuditEntry[] = [];\n  private archivedEntries: AuditEntry[] = [];\n  private entryCounter = 0;\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // CONSTRUCTOR\n  // ─────────────────────────────────────────────────────────────────────────\n\n  constructor(options: InMemoryAuditOptions = {}) {\n    this.options = { ...DEFAULT_OPTIONS, ...options };\n  }\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // LOGGING METHODS\n  // ─────────────────────────────────────────────────────────────────────────\n\n  async log(entry: Omit<AuditEntry, 'id' | 'timestamp'>): Promise<Result<string, Error>> {\n    try {\n      const id = this.generateId();\n      const fullEntry: AuditEntry = {\n        id,\n        timestamp: new Date(),\n        category: entry.category,\n        severity: entry.severity,\n        message: entry.message,\n        data: entry.data,\n        source: entry.source,\n        correlationId: entry.correlationId,\n        tags: entry.tags,\n      };\n\n      this.addEntry(fullEntry);\n\n      return success(id);\n    } catch (error) {\n      return failure(\n        error instanceof Error ? error : new Error('Failed to log entry')\n      );\n    }\n  }\n\n  async logColorDecision(\n    decision: {\n      inputColor: PerceptualColor;\n      outputColor: PerceptualColor;\n      role?: UIRole;\n      state?: UIState;\n      intent?: ComponentIntent;\n      rationale: string;\n    },\n    correlationId?: string\n  ): Promise<Result<string, Error>> {\n    return this.log({\n      category: 'color-decision',\n      severity: 'info',\n      message: `Color decision: ${decision.rationale}`,\n      correlationId,\n      source: 'color-intelligence',\n      data: {\n        inputColor: decision.inputColor.hex,\n        outputColor: decision.outputColor.hex,\n        context: {\n          role: decision.role,\n          state: decision.state,\n          intent: decision.intent,\n        },\n        rationale: decision.rationale,\n        transformations: [],\n      },\n    });\n  }\n\n  async logAccessibilityEvaluation(\n    evaluation: {\n      foreground: PerceptualColor;\n      background: PerceptualColor;\n      wcagRatio: number;\n      apcaLevel: number;\n      requiredLevel: string;\n      passes: boolean;\n      component?: string;\n    },\n    correlationId?: string\n  ): Promise<Result<string, Error>> {\n    return this.log({\n      category: 'accessibility',\n      severity: evaluation.passes ? 'info' : 'warning',\n      message: evaluation.passes\n        ? `Accessibility check passed for ${evaluation.component ?? 'component'}`\n        : `Accessibility check failed for ${evaluation.component ?? 'component'}`,\n      correlationId,\n      source: 'accessibility-checker',\n      data: {\n        foreground: evaluation.foreground.hex,\n        background: evaluation.background.hex,\n        wcagRatio: evaluation.wcagRatio,\n        apcaLevel: evaluation.apcaLevel,\n        requiredLevel: evaluation.requiredLevel,\n        passes: evaluation.passes,\n        component: evaluation.component,\n      },\n    });\n  }\n\n  async logTokenGeneration(\n    generation: {\n      name: string;\n      tokens: DesignToken[];\n      generationTimeMs: number;\n      config?: Record<string, unknown>;\n    },\n    correlationId?: string\n  ): Promise<Result<string, Error>> {\n    const tokenTypes = [...new Set(generation.tokens.map((t) => t.type))];\n\n    return this.log({\n      category: 'token-generation',\n      severity: 'info',\n      message: `Generated ${generation.tokens.length} tokens for ${generation.name}`,\n      correlationId,\n      source: 'token-derivation-service',\n      data: {\n        name: generation.name,\n        tokenCount: generation.tokens.length,\n        tokenTypes,\n        generationTimeMs: generation.generationTimeMs,\n        config: generation.config,\n      },\n    });\n  }\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // QUERY METHODS\n  // ─────────────────────────────────────────────────────────────────────────\n\n  async query(filter: AuditFilter): Promise<Result<AuditEntry[], Error>> {\n    try {\n      let results = [...this.entries];\n\n      // Apply category filter (array of categories)\n      if (filter.categories && filter.categories.length > 0) {\n        results = results.filter((e) => filter.categories!.includes(e.category));\n      }\n\n      // Apply severity filter (array of severities)\n      if (filter.severities && filter.severities.length > 0) {\n        results = results.filter((e) => filter.severities!.includes(e.severity));\n      }\n\n      if (filter.startDate) {\n        results = results.filter((e) => e.timestamp >= filter.startDate!);\n      }\n\n      if (filter.endDate) {\n        results = results.filter((e) => e.timestamp <= filter.endDate!);\n      }\n\n      if (filter.correlationId) {\n        results = results.filter((e) => e.correlationId === filter.correlationId);\n      }\n\n      if (filter.tags && filter.tags.length > 0) {\n        results = results.filter((e) =>\n          e.tags && filter.tags!.some((t) => e.tags!.includes(t))\n        );\n      }\n\n      if (filter.searchText) {\n        const searchLower = filter.searchText.toLowerCase();\n        results = results.filter(\n          (e) =>\n            e.message.toLowerCase().includes(searchLower) ||\n            JSON.stringify(e.data).toLowerCase().includes(searchLower)\n        );\n      }\n\n      // Apply pagination\n      const offset = filter.offset ?? 0;\n      const limit = filter.limit ?? 100;\n      results = results.slice(offset, offset + limit);\n\n      return success(results);\n    } catch (error) {\n      return failure(\n        error instanceof Error ? error : new Error('Failed to query entries')\n      );\n    }\n  }\n\n  async getById(id: string): Promise<Result<AuditEntry | null, Error>> {\n    const entry = this.entries.find((e) => e.id === id);\n    return success(entry ?? null);\n  }\n\n  async getByCorrelation(correlationId: string): Promise<Result<AuditEntry[], Error>> {\n    const entries = this.entries.filter((e) => e.correlationId === correlationId);\n    return success(entries);\n  }\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // REPORT METHODS\n  // ─────────────────────────────────────────────────────────────────────────\n\n  async generateReport(startDate: Date, endDate: Date): Promise<Result<AuditReport, Error>> {\n    try {\n      const periodEntries = this.entries.filter(\n        (e) => e.timestamp >= startDate && e.timestamp <= endDate\n      );\n\n      // Calculate statistics by category\n      const byCategory = this.initializeCategoryRecord();\n      for (const entry of periodEntries) {\n        byCategory[entry.category]++;\n      }\n\n      // Calculate statistics by severity\n      const bySeverity = this.initializeSeverityRecord();\n      for (const entry of periodEntries) {\n        bySeverity[entry.severity]++;\n      }\n\n      // Count unique correlations\n      const correlations = new Set(\n        periodEntries.filter((e) => e.correlationId).map((e) => e.correlationId)\n      );\n\n      // Accessibility metrics\n      const accessibilityEntries = periodEntries.filter(\n        (e) => e.category === 'accessibility'\n      );\n      const passedAccessibility = accessibilityEntries.filter(\n        (e) => (e.data as { passes?: boolean })?.passes === true\n      );\n      const wcagRatios = accessibilityEntries\n        .map((e) => (e.data as { wcagRatio?: number })?.wcagRatio)\n        .filter((r): r is number => typeof r === 'number');\n      const apcaLevels = accessibilityEntries\n        .map((e) => (e.data as { apcaLevel?: number })?.apcaLevel)\n        .filter((l): l is number => typeof l === 'number');\n      const failedComponents = [\n        ...new Set(\n          accessibilityEntries\n            .filter((e) => (e.data as { passes?: boolean })?.passes === false)\n            .map((e) => (e.data as { component?: string })?.component)\n            .filter((c): c is string => typeof c === 'string')\n        ),\n      ];\n\n      // Token metrics\n      const tokenEntries = periodEntries.filter(\n        (e) => e.category === 'token-generation'\n      );\n      const tokenCounts = tokenEntries\n        .map((e) => (e.data as { tokenCount?: number })?.tokenCount)\n        .filter((c): c is number => typeof c === 'number');\n      const generationTimes = tokenEntries\n        .map((e) => (e.data as { generationTimeMs?: number })?.generationTimeMs)\n        .filter((t): t is number => typeof t === 'number');\n      const tokenTypeEntries = tokenEntries.flatMap((e) =>\n        ((e.data as { tokenTypes?: string[] })?.tokenTypes ?? [])\n      );\n      const tokenByType: Record<string, number> = {};\n      for (const type of tokenTypeEntries) {\n        tokenByType[type] = (tokenByType[type] ?? 0) + 1;\n      }\n\n      // Highlighted issues (errors and critical)\n      const highlightedIssues = periodEntries.filter(\n        (e) => e.severity === 'error' || e.severity === 'critical'\n      );\n\n      // Recommendations\n      const recommendations = this.generateRecommendations(periodEntries);\n\n      const report: AuditReport = {\n        period: {\n          start: startDate,\n          end: endDate,\n        },\n        summary: {\n          totalEvents: periodEntries.length,\n          byCategory,\n          bySeverity,\n          uniqueCorrelations: correlations.size,\n        },\n        accessibility: {\n          totalEvaluations: accessibilityEntries.length,\n          passRate:\n            accessibilityEntries.length > 0\n              ? passedAccessibility.length / accessibilityEntries.length\n              : 1,\n          failedComponents,\n          avgWcagRatio:\n            wcagRatios.length > 0\n              ? wcagRatios.reduce((a, b) => a + b, 0) / wcagRatios.length\n              : 0,\n          avgApcaLevel:\n            apcaLevels.length > 0\n              ? apcaLevels.reduce((a, b) => a + b, 0) / apcaLevels.length\n              : 0,\n        },\n        tokens: {\n          totalGenerated: tokenCounts.reduce((a, b) => a + b, 0),\n          avgGenerationTimeMs:\n            generationTimes.length > 0\n              ? generationTimes.reduce((a, b) => a + b, 0) / generationTimes.length\n              : 0,\n          byType: tokenByType,\n        },\n        highlightedIssues,\n        recommendations,\n      };\n\n      return success(report);\n    } catch (error) {\n      return failure(\n        error instanceof Error ? error : new Error('Failed to generate report')\n      );\n    }\n  }\n\n  async getStats(): Promise<Result<AuditStats, Error>> {\n    try {\n      const now = new Date();\n      const oneHourAgo = new Date(now.getTime() - 60 * 60 * 1000);\n      const todayStart = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n\n      const lastHourEntries = this.entries.filter((e) => e.timestamp >= oneHourAgo);\n      const todayEntries = this.entries.filter((e) => e.timestamp >= todayStart);\n\n      // Today by category\n      const todayByCategory = this.initializeCategoryRecord();\n      for (const entry of todayEntries) {\n        todayByCategory[entry.category]++;\n      }\n\n      // Accessibility pass rate\n      const accessibilityEntries = this.entries.filter(\n        (e) => e.category === 'accessibility'\n      );\n      const passedCount = accessibilityEntries.filter(\n        (e) => (e.data as { passes?: boolean })?.passes === true\n      ).length;\n      const accessibilityPassRate =\n        accessibilityEntries.length > 0\n          ? passedCount / accessibilityEntries.length\n          : 1;\n\n      // Top issue components\n      const componentIssues: Record<string, number> = {};\n      const issueEntries = this.entries.filter(\n        (e) => e.severity === 'error' || e.severity === 'warning'\n      );\n      for (const entry of issueEntries) {\n        const component =\n          (entry.data as { component?: string })?.component ?? 'unknown';\n        componentIssues[component] = (componentIssues[component] ?? 0) + 1;\n      }\n      const topIssueComponents = Object.entries(componentIssues)\n        .map(([name, count]) => ({ name, count }))\n        .sort((a, b) => b.count - a.count)\n        .slice(0, 10);\n\n      const stats: AuditStats = {\n        lastHour: {\n          total: lastHourEntries.length,\n          errors: lastHourEntries.filter((e) => e.severity === 'error').length,\n          warnings: lastHourEntries.filter((e) => e.severity === 'warning').length,\n        },\n        today: {\n          total: todayEntries.length,\n          byCategory: todayByCategory,\n        },\n        accessibilityPassRate,\n        topIssueComponents,\n      };\n\n      return success(stats);\n    } catch (error) {\n      return failure(\n        error instanceof Error ? error : new Error('Failed to get stats')\n      );\n    }\n  }\n\n  async export(\n    filter: AuditFilter,\n    format: 'json' | 'csv' | 'html'\n  ): Promise<Result<string, Error>> {\n    const queryResult = await this.query(filter);\n    if (!queryResult.success) {\n      return failure(queryResult.error);\n    }\n\n    const entries = queryResult.value;\n\n    switch (format) {\n      case 'json':\n        return success(JSON.stringify(entries, null, 2));\n\n      case 'csv': {\n        if (entries.length === 0) {\n          return success('id,timestamp,category,severity,message,correlationId\\n');\n        }\n        const headers = ['id', 'timestamp', 'category', 'severity', 'message', 'correlationId'];\n        const rows = entries.map((e) => [\n          e.id,\n          e.timestamp.toISOString(),\n          e.category,\n          e.severity,\n          e.message.replace(/\"/g, '\"\"'),\n          e.correlationId ?? '',\n        ]);\n        const csv = [\n          headers.join(','),\n          ...rows.map((r) => r.map((v) => `\"${v}\"`).join(',')),\n        ].join('\\n');\n        return success(csv);\n      }\n\n      case 'html': {\n        const rows = entries\n          .map(\n            (e) => `\n          <tr>\n            <td>${e.timestamp.toISOString()}</td>\n            <td>${e.category}</td>\n            <td class=\"severity-${e.severity}\">${e.severity}</td>\n            <td>${e.message}</td>\n          </tr>`\n          )\n          .join('');\n\n        const html = `\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Audit Report</title>\n  <style>\n    table { border-collapse: collapse; width: 100%; }\n    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\n    th { background-color: #4CAF50; color: white; }\n    .severity-info { color: #2196F3; }\n    .severity-warning { color: #FF9800; }\n    .severity-error { color: #F44336; }\n    .severity-critical { color: #9C27B0; font-weight: bold; }\n  </style>\n</head>\n<body>\n  <h1>Audit Report</h1>\n  <p>Total entries: ${entries.length}</p>\n  <table>\n    <thead>\n      <tr><th>Timestamp</th><th>Category</th><th>Severity</th><th>Message</th></tr>\n    </thead>\n    <tbody>${rows}</tbody>\n  </table>\n</body>\n</html>`;\n        return success(html);\n      }\n\n      default:\n        return failure(new Error(`Unsupported format: ${format}`));\n    }\n  }\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // MAINTENANCE METHODS\n  // ─────────────────────────────────────────────────────────────────────────\n\n  async purge(olderThan: Date): Promise<Result<number, Error>> {\n    try {\n      const initialCount = this.entries.length;\n      this.entries = this.entries.filter((e) => e.timestamp >= olderThan);\n      const purgedCount = initialCount - this.entries.length;\n      return success(purgedCount);\n    } catch (error) {\n      return failure(\n        error instanceof Error ? error : new Error('Failed to purge entries')\n      );\n    }\n  }\n\n  async archive(olderThan: Date): Promise<Result<number, Error>> {\n    try {\n      const toArchive = this.entries.filter((e) => e.timestamp < olderThan);\n      this.archivedEntries.push(...toArchive);\n      this.entries = this.entries.filter((e) => e.timestamp >= olderThan);\n      return success(toArchive.length);\n    } catch (error) {\n      return failure(\n        error instanceof Error ? error : new Error('Failed to archive entries')\n      );\n    }\n  }\n\n  async isAvailable(): Promise<boolean> {\n    return true;\n  }\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // ADDITIONAL PUBLIC METHODS (not in port, for testing)\n  // ─────────────────────────────────────────────────────────────────────────\n\n  /**\n   * Clears all entries. For testing purposes.\n   */\n  async clear(): Promise<Result<void, Error>> {\n    this.entries = [];\n    this.archivedEntries = [];\n    this.entryCounter = 0;\n    return success(undefined);\n  }\n\n  /**\n   * Gets archived entries. For testing purposes.\n   */\n  getArchivedEntries(): readonly AuditEntry[] {\n    return this.archivedEntries;\n  }\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // PRIVATE METHODS\n  // ─────────────────────────────────────────────────────────────────────────\n\n  private generateId(): string {\n    this.entryCounter++;\n    return `audit-${Date.now()}-${this.entryCounter}`;\n  }\n\n  private addEntry(entry: AuditEntry): void {\n    // Console logging if enabled\n    if (this.options.consoleLogging) {\n      this.logToConsole(entry);\n    }\n\n    // Callback\n    this.options.onEntry(entry);\n\n    // Add to entries\n    this.entries.push(entry);\n\n    // Enforce max entries limit\n    if (this.entries.length > this.options.maxEntries) {\n      this.entries = this.entries.slice(-this.options.maxEntries);\n    }\n  }\n\n  private logToConsole(entry: AuditEntry): void {\n    const severityLevels: Record<AuditSeverity, number> = {\n      info: 0,\n      warning: 1,\n      error: 2,\n      critical: 3,\n    };\n\n    const configLevel = severityLevels[this.options.logLevel];\n    const entryLevel = severityLevels[entry.severity];\n\n    if (entryLevel < configLevel) return;\n\n    const timestamp = entry.timestamp.toISOString();\n    const prefix = `[${timestamp}] [${entry.category}] [${entry.severity.toUpperCase()}]`;\n\n    switch (entry.severity) {\n      case 'critical':\n      case 'error':\n        console.error(`${prefix} ${entry.message}`, entry.data);\n        break;\n      case 'warning':\n        console.warn(`${prefix} ${entry.message}`, entry.data);\n        break;\n      default:\n        console.log(`${prefix} ${entry.message}`, entry.data);\n    }\n  }\n\n  private initializeCategoryRecord(): Record<AuditCategory, number> {\n    return {\n      'color-decision': 0,\n      accessibility: 0,\n      'token-generation': 0,\n      'token-modification': 0,\n      'theme-change': 0,\n      export: 0,\n      import: 0,\n      validation: 0,\n      performance: 0,\n    };\n  }\n\n  private initializeSeverityRecord(): Record<AuditSeverity, number> {\n    return {\n      info: 0,\n      warning: 0,\n      error: 0,\n      critical: 0,\n    };\n  }\n\n  private generateRecommendations(entries: AuditEntry[]): string[] {\n    const recommendations: string[] = [];\n\n    // Check for critical issues\n    const criticalCount = entries.filter((e) => e.severity === 'critical').length;\n    if (criticalCount > 0) {\n      recommendations.push(`Address ${criticalCount} critical issues immediately`);\n    }\n\n    // Check accessibility\n    const accessibilityFails = entries.filter(\n      (e) =>\n        e.category === 'accessibility' &&\n        (e.data as { passes?: boolean })?.passes === false\n    ).length;\n    if (accessibilityFails > 5) {\n      recommendations.push(\n        'Review color contrast ratios for accessibility compliance'\n      );\n    }\n\n    // Check color consistency\n    const colorDecisions = entries.filter((e) => e.category === 'color-decision');\n    if (colorDecisions.length > 100) {\n      recommendations.push(\n        'Consider consolidating color tokens to reduce complexity'\n      );\n    }\n\n    // Check performance\n    const slowOps = entries.filter(\n      (e) => e.category === 'performance' && e.severity === 'warning'\n    ).length;\n    if (slowOps > 10) {\n      recommendations.push('Optimize slow operations to improve performance');\n    }\n\n    if (recommendations.length === 0) {\n      recommendations.push('No immediate actions required');\n    }\n\n    return recommendations;\n  }\n}\n\n// ============================================================================\n// EXPORTS\n// ============================================================================\n\nexport default InMemoryAuditAdapter;\n"]}